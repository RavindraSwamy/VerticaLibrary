create procedure EDW.SP_ACCOUNT_ATTRIBUTE()
begin
  create table #ATT_NAMES(
    ATTRIB_NAME varchar(200) null,
    SEQ integer null,);
  commit work;
  insert into #ATT_NAMES values( 'DELIVERABLE_IN_TRANSIT',1 ) ;
  insert into #ATT_NAMES values( 'FAILURE_REASON',1 ) ;
  insert into #ATT_NAMES values( 'PARTICULARS',1 ) ;
  insert into #ATT_NAMES values( 'TRACKING_NO',1 ) ;
  insert into #ATT_NAMES values( 'DELIVERY_DUE_DATE',1 ) ;
  insert into #ATT_NAMES values( 'INCIDENT_NO',1 ) ;
  insert into #ATT_NAMES values( 'SR NO',1 ) ;
  insert into #ATT_NAMES values( 'SR TYPE',1 ) ;
  insert into #ATT_NAMES values( 'SR_CATEGORY',1 ) ;
  insert into #ATT_NAMES values( 'SR_LOG_DATE',1 ) ;
  insert into #ATT_NAMES values( 'SR_DUE_DATE',1 ) ;
  insert into #ATT_NAMES values( 'SR_STATUS',1 ) ;
  insert into #ATT_NAMES values( 'SR_CHANNEL',1 ) ;
  insert into #ATT_NAMES values( 'SR_PRODUCT_LINE',1 ) ;
  insert into #ATT_NAMES values( 'RBC_LIMIT AMOUNT',1 ) ;
  insert into #ATT_NAMES values( 'RBC_DATE OF LIMIT RENEWAL',1 ) ;
  insert into #ATT_NAMES values( 'RBC_INTEREST DEBIT AMOUNT',1 ) ;
  insert into #ATT_NAMES values( 'RBC_DATE OF INTEREST DEBIT',1 ) ;
  insert into #ATT_NAMES values( 'RBC_OVERDRAWN AMOUNT',1 ) ;
  insert into #ATT_NAMES values( 'RBC_DATE OF OVERDRAWN',1 ) ;
  insert into #ATT_NAMES values( 'RBC_DATE OF LIMIT EXPIRY',1 ) ;
  insert into #ATT_NAMES values( 'BILLER NAME',1 ) ;
  insert into #ATT_NAMES values( 'AMOUNT',1 ) ;
  insert into #ATT_NAMES values( 'BILL DUE DATE',1 ) ;
  commit work;
  update MCCM.TEMP_ACCOUNT_ATTRIBUTE_N_MUR
    set seq = 1;
  commit work;
  select A.UCIC_CODE,A.SOURCE_SYSTEM_CODE,A.SOURCE_PARTY_ID,A.SOURCE_ACCOUNT_NBR,B.ATTRIB_NAME,
    cast(null as decimal(30,4)) as ATTRIB_VALUE_NUMERIC,
    cast(null as varchar(100)) as ATTRIB_VALUE_CHARACTER,
    cast(null as date) as ATTRIB_VALUE_DATE,
    A.ASOF_DATE,A.EXPIRY_REVIEW_DATE,A.SCORE
    into #ACCOUNT_ATTRIBUTE4
    from MCCM.TEMP_ACCOUNT_ATTRIBUTE_N_MUR as A,#ATT_NAMES as B
    where a.SEQ = B.SEQ;
  commit work;
  create hg index IDX_SRC_NBR1 on #ACCOUNT_ATTRIBUTE4(SOURCE_ACCOUNT_NBR);
  commit work;
  update #ACCOUNT_ATTRIBUTE4 as A
    set A.ATTRIB_VALUE_CHARACTER = B.DELIVERABLE_IN_TRANSIT from
    MCCM.TEMP_ACCOUNT_ATTRIBUTE_N_MUR as B
    where A.SOURCE_ACCOUNT_NBR = B.SOURCE_ACCOUNT_NBR
    and ATTRIB_NAME = 'DELIVERABLE_IN_TRANSIT';
  commit work;
  update #ACCOUNT_ATTRIBUTE4 as A
    set A.ATTRIB_VALUE_CHARACTER = B.FAILURE_REASON from
    MCCM.TEMP_ACCOUNT_ATTRIBUTE_N_MUR as B
    where A.SOURCE_ACCOUNT_NBR = B.SOURCE_ACCOUNT_NBR
    and ATTRIB_NAME = 'FAILURE_REASON';
  commit work;
  update #ACCOUNT_ATTRIBUTE4 as A
    set A.ATTRIB_VALUE_CHARACTER = B.PARTICULARS from
    MCCM.TEMP_ACCOUNT_ATTRIBUTE_N_MUR as B
    where A.SOURCE_ACCOUNT_NBR = B.SOURCE_ACCOUNT_NBR
    and ATTRIB_NAME = 'PARTICULARS';
  commit work;
  update #ACCOUNT_ATTRIBUTE4 as A
    set A.ATTRIB_VALUE_NUMERIC = B.TRACKING_NO from
    MCCM.TEMP_ACCOUNT_ATTRIBUTE_N_MUR as B
    where A.SOURCE_ACCOUNT_NBR = B.SOURCE_ACCOUNT_NBR
    and ATTRIB_NAME = 'TRACKING_NO';
  commit work;
  update #ACCOUNT_ATTRIBUTE4 as A
    set A.ATTRIB_VALUE_DATE = B.DELIVERY_DUE_DATE from
    MCCM.TEMP_ACCOUNT_ATTRIBUTE_N_MUR as B
    where A.SOURCE_ACCOUNT_NBR = B.SOURCE_ACCOUNT_NBR
    and ATTRIB_NAME = 'DELIVERY_DUE_DATE';
  commit work;
  update #ACCOUNT_ATTRIBUTE4 as A
    set A.ATTRIB_VALUE_NUMERIC = B.INCIDENT_NO from
    MCCM.TEMP_ACCOUNT_ATTRIBUTE_N_MUR as B
    where A.SOURCE_ACCOUNT_NBR = B.SOURCE_ACCOUNT_NBR
    and ATTRIB_NAME = 'INCIDENT_NO';
  commit work;
  update #ACCOUNT_ATTRIBUTE4 as A
    set A.ATTRIB_VALUE_NUMERIC = B.SRNO from
    MCCM.TEMP_ACCOUNT_ATTRIBUTE_N_MUR as B
    where A.SOURCE_ACCOUNT_NBR = B.SOURCE_ACCOUNT_NBR
    and ATTRIB_NAME = 'SR NO';
  commit work;
  update #ACCOUNT_ATTRIBUTE4 as A
    set A.ATTRIB_VALUE_CHARACTER = B.SRTYPE from
    MCCM.TEMP_ACCOUNT_ATTRIBUTE_N_MUR as B
    where A.SOURCE_ACCOUNT_NBR = B.SOURCE_ACCOUNT_NBR
    and ATTRIB_NAME = 'SR TYPE';
  commit work;
  update #ACCOUNT_ATTRIBUTE4 as A
    set A.ATTRIB_VALUE_CHARACTER = B.SR_CATEGORY from
    MCCM.TEMP_ACCOUNT_ATTRIBUTE_N_MUR as B
    where A.SOURCE_ACCOUNT_NBR = B.SOURCE_ACCOUNT_NBR
    and ATTRIB_NAME = 'SR_CATEGORY';
  commit work;
  update #ACCOUNT_ATTRIBUTE4 as A
    set A.ATTRIB_VALUE_DATE = B.SR_LOG_DATE from
    MCCM.TEMP_ACCOUNT_ATTRIBUTE_N_MUR as B
    where A.SOURCE_ACCOUNT_NBR = B.SOURCE_ACCOUNT_NBR
    and ATTRIB_NAME = 'SR_LOG_DATE';
  commit work;
  update #ACCOUNT_ATTRIBUTE4 as A
    set A.ATTRIB_VALUE_DATE = B.SR_DUE_DATE from
    MCCM.TEMP_ACCOUNT_ATTRIBUTE_N_MUR as B
    where A.SOURCE_ACCOUNT_NBR = B.SOURCE_ACCOUNT_NBR
    and ATTRIB_NAME = 'SR_DUE_DATE';
  commit work;
  update #ACCOUNT_ATTRIBUTE4 as A
    set A.ATTRIB_VALUE_CHARACTER = B.SR_STATUS from
    MCCM.TEMP_ACCOUNT_ATTRIBUTE_N_MUR as B
    where A.SOURCE_ACCOUNT_NBR = B.SOURCE_ACCOUNT_NBR
    and ATTRIB_NAME = 'SR_STATUS';
  commit work;
  update #ACCOUNT_ATTRIBUTE4 as A
    set A.ATTRIB_VALUE_CHARACTER = B.SR_CHANNEL from
    MCCM.TEMP_ACCOUNT_ATTRIBUTE_N_MUR as B
    where A.SOURCE_ACCOUNT_NBR = B.SOURCE_ACCOUNT_NBR
    and ATTRIB_NAME = 'SR_CHANNEL';
  commit work;
  update #ACCOUNT_ATTRIBUTE4 as A
    set A.ATTRIB_VALUE_CHARACTER = B.SR_PRODUCT_LINE from
    MCCM.TEMP_ACCOUNT_ATTRIBUTE_N_MUR as B
    where A.SOURCE_ACCOUNT_NBR = B.SOURCE_ACCOUNT_NBR
    and ATTRIB_NAME = 'SR_PRODUCT_LINE';
  commit work;
  update #ACCOUNT_ATTRIBUTE4 as A
    set A.ATTRIB_VALUE_NUMERIC = B.RBC_LIMIT_AMOUNT from
    MCCM.TEMP_ACCOUNT_ATTRIBUTE_N_MUR as B
    where A.SOURCE_ACCOUNT_NBR = B.SOURCE_ACCOUNT_NBR
    and ATTRIB_NAME = 'RBC_LIMIT AMOUNT';
  commit work;
  update #ACCOUNT_ATTRIBUTE4 as A
    set A.ATTRIB_VALUE_DATE = B.RBC_DATE_OF_LIMIT_RENEWAL from
    MCCM.TEMP_ACCOUNT_ATTRIBUTE_N_MUR as B
    where A.SOURCE_ACCOUNT_NBR = B.SOURCE_ACCOUNT_NBR
    and ATTRIB_NAME = 'RBC_DATE OF LIMIT RENEWAL';
  commit work;
  update #ACCOUNT_ATTRIBUTE4 as A
    set A.ATTRIB_VALUE_NUMERIC = B.RBC_INTEREST_DEBIT_AMOUNT from
    MCCM.TEMP_ACCOUNT_ATTRIBUTE_N_MUR as B
    where A.SOURCE_ACCOUNT_NBR = B.SOURCE_ACCOUNT_NBR
    and ATTRIB_NAME = 'RBC_INTEREST DEBIT AMOUNT';
  commit work;
  update #ACCOUNT_ATTRIBUTE4 as A
    set A.ATTRIB_VALUE_DATE = B.RBC_DATE_OF_INTEREST_DEBIT from
    MCCM.TEMP_ACCOUNT_ATTRIBUTE_N_MUR as B
    where A.SOURCE_ACCOUNT_NBR = B.SOURCE_ACCOUNT_NBR
    and ATTRIB_NAME = 'RBC_DATE OF INTEREST DEBIT';
  commit work;
  update #ACCOUNT_ATTRIBUTE4 as A
    set A.ATTRIB_VALUE_NUMERIC = B.RBC_OVERDRAWN_AMOUNT from
    MCCM.TEMP_ACCOUNT_ATTRIBUTE_N_MUR as B
    where A.SOURCE_ACCOUNT_NBR = B.SOURCE_ACCOUNT_NBR
    and ATTRIB_NAME = 'RBC_OVERDRAWN AMOUNT';
  commit work;
  update #ACCOUNT_ATTRIBUTE4 as A
    set A.ATTRIB_VALUE_DATE = B.RBC_DATE_OF_OVERDRAWN from
    MCCM.TEMP_ACCOUNT_ATTRIBUTE_N_MUR as B
    where A.SOURCE_ACCOUNT_NBR = B.SOURCE_ACCOUNT_NBR
    and ATTRIB_NAME = 'RBC_DATE OF OVERDRAWN';
  commit work;
  update #ACCOUNT_ATTRIBUTE4 as A
    set A.ATTRIB_VALUE_DATE = B.RBC_DATE_OF_LIMIT_EXPIRY from
    MCCM.TEMP_ACCOUNT_ATTRIBUTE_N_MUR as B
    where A.SOURCE_ACCOUNT_NBR = B.SOURCE_ACCOUNT_NBR
    and ATTRIB_NAME = 'RBC_DATE OF LIMIT EXPIRY';
  commit work;
  update #ACCOUNT_ATTRIBUTE4 as A
    set A.ATTRIB_VALUE_CHARACTER = B.BILLER_NAME from
    MCCM.TEMP_ACCOUNT_ATTRIBUTE_N_MUR as B
    where A.SOURCE_ACCOUNT_NBR = B.SOURCE_ACCOUNT_NBR
    and ATTRIB_NAME = 'BILLER NAME';
  commit work;
  update #ACCOUNT_ATTRIBUTE4 as A
    set A.ATTRIB_VALUE_NUMERIC = B.AMOUNT from
    MCCM.TEMP_ACCOUNT_ATTRIBUTE_N_MUR as B
    where A.SOURCE_ACCOUNT_NBR = B.SOURCE_ACCOUNT_NBR
    and ATTRIB_NAME = 'AMOUNT';
  commit work;
  update #ACCOUNT_ATTRIBUTE4 as A
    set A.ATTRIB_VALUE_DATE = B.BILL_DUE_DATE from
    MCCM.TEMP_ACCOUNT_ATTRIBUTE_N_MUR as B
    where A.SOURCE_ACCOUNT_NBR = B.SOURCE_ACCOUNT_NBR
    and ATTRIB_NAME = 'BILL DUE DATE';
  commit work;
  drop table MCCM.ACCOUNT_ATTRIBUTE;
  commit work;
  select * into MCCM.ACCOUNT_ATTRIBUTE from #ACCOUNT_ATTRIBUTE4;
  commit work
end
