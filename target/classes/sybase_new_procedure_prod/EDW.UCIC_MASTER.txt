create procedure EDW.UCIC_MASTER()
begin
  select distinct
    UCIC_VALUE,
    cast(null as varchar(30)) as SOURCE_PARTY_ID,
    cast(null as integer) as SOURCE_SYSTEM_CODE,
    cast(null as varchar(25)) as NAME_PREFIX,
    cast(null as varchar(80)) as FULL_NAME,
    cast(null as date) as BIRTH_DATE,
    cast(null as varchar(5)) as GENDER,
    cast(null as integer) as AGE,
    cast(null as varchar(80)) as OCCUPATION,
    cast(null as varchar(5)) as MARITAL_STATUS,
    cast(null as varchar(5)) as EMPLOYMENT_TYPE,
    cast(null as varchar(100)) as CUR_ADDRESS_1,
    cast(null as varchar(100)) as CUR_ADDRESS_2,
    cast(null as varchar(100)) as CUR_ADDRESS_3,
    cast(null as varchar(100)) as CUR_ADDRESS_4,
    cast(null as varchar(50)) as CUR_CITY,
    cast(null as varchar(50)) as CUR_STATE,
    cast(null as varchar(40)) as CUR_PIN,
    cast(null as varchar(50)) as CUR_COUNTRY,
    cast(null as varchar(100)) as PER_ADDRESS_1,
    cast(null as varchar(100)) as PER_ADDRESS_2,
    cast(null as varchar(100)) as PER_ADDRESS_3,
    cast(null as varchar(100)) as PER_ADDRESS_4,
    cast(null as varchar(50)) as PER_CITY,
    cast(null as varchar(50)) as PER_STATE,
    cast(null as varchar(40)) as PER_PIN,
    cast(null as varchar(50)) as PER_COUNTRY,
    cast(null as varchar(100)) as BUS_ADDRESS_1,
    cast(null as varchar(100)) as BUS_ADDRESS_2,
    cast(null as varchar(100)) as BUS_ADDRESS_3,
    cast(null as varchar(100)) as BUS_ADDRESS_4,
    cast(null as varchar(50)) as BUS_CITY,
    cast(null as varchar(50)) as BUS_STATE,
    cast(null as varchar(40)) as BUS_PIN,
    cast(null as varchar(50)) as BUS_COUNTRY,
    cast(null as varchar(100)) as MAIL_ADDRESS_1,
    cast(null as varchar(100)) as MAIL_ADDRESS_2,
    cast(null as varchar(100)) as MAIL_ADDRESS_3,
    cast(null as varchar(100)) as MAIL_ADDRESS_4,
    cast(null as varchar(50)) as MAIL_CITY,
    cast(null as varchar(50)) as MAIL_STATE,
    cast(null as varchar(40)) as MAIL_PIN,
    cast(null as varchar(50)) as MAIL_COUNTRY,
    cast(null as varchar(30)) as PHONE,
    cast('N' as varchar(5)) as IMOBILE_ACTIVE,
    cast('N' as varchar(5)) as INTERNET_ACTIVE,
    cast('N' as varchar(5)) as ATM_ACTIVE,
    cast('N' as varchar(5)) as POS_ACTIVE,
    cast('N' as varchar(5)) as BRANCH_ACTIVE,
    cast('N' as varchar(5)) as LIABILITY_ACCT_HOLDER,
    cast('N' as varchar(5)) as CARD_ACCT_HOLDER,
    cast('N' as varchar(5)) as DEMAT_ACCT_HOLDER,
    cast('N' as varchar(5)) as LOAN_ACCT_HOLDER,
    cast('N' as varchar(5)) as MOBILE_ACCT_HOLDER,
    cast('N' as varchar(5)) as SERVICE_REQUEST_OPEN,
    cast('N' as varchar(5)) as DELIVERABLE_IN_TRANSIT,
    cast(null as date) as LAST_CALLCENTER_CONTACT_DATE,
    cast(null as varchar(100)) as CSM_NAME,
    cast(null as varchar(80)) as CSM_EMAILID,
    cast(null as varchar(20)) as CSM_NUMBER,
    cast(null as varchar(80)) as RM_EMAILID,
    cast(null as varchar(20)) as RM_NUMBER,
    cast(null as varchar(100)) as RM_NAME,
    cast(null as varchar(5)) as SERVICE_SEGMENT,
    cast(null as varchar(5)) as INCOME_SEGMENT,
    cast(null as varchar(4)) as CREDIT_SCORE,
    cast('N' as varchar(5)) as DELINQUENT_CUSTOMER,
    cast(null as varchar(5)) as FRAUD_CUSTOMER_FLAG,
    cast(null as varchar(80)) as ACC_HOLDER,
    GETDATE() as AS_OF_DATE,
    cast(null as varchar(5)) as POCKETS_DOWNLOADED,
    cast('N' as varchar(5)) as SHOPPING_ACTIVE
    into #TEMP_UCIC_MASTER_N_SRINI
    from P2C.UCIC_LINKAGE_TABLE_UPDATED_FINAL;
  if sqlstate <> '00000' then
    return
  end if;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.SOURCE_PARTY_ID = B.SOURCE_PARTY_ID,
    A.SOURCE_SYSTEM_CODE = B.SOURCE_SYSTEM_CODE from
    (select UCIC_VALUE,SOURCE_PARTY_ID,ACCOUNT_OPEN_DATE,SOURCE_SYSTEM_CODE from P2C.UCIC_LINKAGE_TABLE_UPDATED_FINAL where ACCOUNT_OPEN_DATE
       = any(select MAX(ACCOUNT_OPEN_DATE) from P2C.UCIC_LINKAGE_TABLE_UPDATED_FINAL
        --WHERE UCIC_VALUE='0000000086387670' 
        group by UCIC_VALUE)) as B
    --AND UCIC_VALUE='0000000086387670'
    where TRIM(A.UCIC_VALUE) = TRIM(B.UCIC_VALUE);
  if sqlstate <> '00000' then
    return
  end if;
  commit work;
  create hg index UCIC_MASTER_1 on EDW.#TEMP_UCIC_MASTER_N_SRINI(SOURCE_PARTY_ID,SOURCE_SYSTEM_CODE);
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.NAME_PREFIX = B.NAME_PREFIX,
    A.FULL_NAME = B.FULL_NAME,
    A.BIRTH_DATE = B.BIRTH_DATE,
    A.GENDER = B.GENDER,
    A.AGE = (case when B.BIRTH_DATE <> '1900-01-01' then DATEDIFF(yy,B.BIRTH_DATE,GETDATE()) else null end),
    A.OCCUPATION = B.PROFESSION,
    A.MARITAL_STATUS = B.MARITAL_STATUS,
    A.EMPLOYMENT_TYPE = B.EMPLOYMENT_TYPE,
    A.CUR_ADDRESS_1 = B.CUR_ADDRESS_LINE1,
    A.CUR_ADDRESS_2 = B.CUR_ADDRESS_LINE2,
    A.CUR_ADDRESS_3 = B.CUR_ADDRESS_LINE3,
    A.CUR_ADDRESS_4 = B.CUR_ADDRESS_LINE4,
    A.CUR_CITY = B.CUR_CITY,
    A.CUR_STATE = B.CUR_STATE,
    A.CUR_PIN = B.CUR_PIN,
    A.CUR_COUNTRY = B.CUR_COUNTRY,
    A.PER_ADDRESS_1 = B.PER_ADDRESS_LINE1,
    A.PER_ADDRESS_2 = B.PER_ADDRESS_LINE2,
    A.PER_ADDRESS_3 = B.PER_ADDRESS_LINE3,
    A.PER_ADDRESS_4 = B.PER_ADDRESS_LINE4,
    A.PER_CITY = B.PER_CITY,
    A.PER_STATE = B.PER_STATE,
    A.PER_PIN = B.PER_PIN,
    A.PER_COUNTRY = B.PER_COUNTRY,
    A.BUS_ADDRESS_1 = B.BUS_ADDRESS_LINE1,
    A.BUS_ADDRESS_2 = B.BUS_ADDRESS_LINE2,
    A.BUS_ADDRESS_3 = B.BUS_ADDRESS_LINE3,
    A.BUS_ADDRESS_4 = B.BUS_ADDRESS_LINE4,
    A.BUS_CITY = B.BUS_CITY,
    A.BUS_STATE = B.BUS_STATE,
    A.BUS_PIN = B.BUS_PIN,
    A.BUS_COUNTRY = B.BUS_COUNTRY,
    A.MAIL_ADDRESS_1 = B.MAIL_ADDRESS_LINE1,
    A.MAIL_ADDRESS_2 = B.MAIL_ADDRESS_LINE2,
    A.MAIL_ADDRESS_3 = B.MAIL_ADDRESS_LINE3,
    A.MAIL_ADDRESS_4 = B.MAIL_ADDRESS_LINE4,
    A.MAIL_CITY = B.MAIL_CITY,
    A.MAIL_STATE = B.MAIL_STATE,
    A.MAIL_PIN = B.MAIL_PIN,
    A.MAIL_COUNTRY = B.MAIL_COUNTRY,
    A.PHONE = B.MOBILENUMBER from
    EDW.T0111_SOURCE_CUSTOMER_DETAILS as B
    where A.SOURCE_PARTY_ID = B.SOURCE_PARTY_ID and A.SOURCE_SYSTEM_CODE = B.SOURCE_SYSTEM_CODE;
  if sqlstate <> '00000' then
    return
  end if;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.NAME_PREFIX = B.NAME_PREFIX,
    A.FULL_NAME = B.FULL_NAME,
    A.BIRTH_DATE = B.BIRTH_DATE,
    A.GENDER = B.GENDER,
    A.AGE = (case when B.BIRTH_DATE <> '1900-01-01' then DATEDIFF(yy,B.BIRTH_DATE,GETDATE()) else null end),
    A.OCCUPATION = B.PROFESSION,
    A.MARITAL_STATUS = B.MARITAL_STATUS,
    A.EMPLOYMENT_TYPE = B.EMPLOYMENT_TYPE,
    A.CUR_ADDRESS_1 = B.CUR_ADDRESS_LINE1,
    A.CUR_ADDRESS_2 = B.CUR_ADDRESS_LINE2,
    A.CUR_ADDRESS_3 = B.CUR_ADDRESS_LINE3,
    A.CUR_ADDRESS_4 = B.CUR_ADDRESS_LINE4,
    A.CUR_CITY = B.CUR_CITY,
    A.CUR_STATE = B.CUR_STATE,
    A.CUR_PIN = B.CUR_PIN,
    A.CUR_COUNTRY = B.CUR_COUNTRY,
    A.PER_ADDRESS_1 = B.PER_ADDRESS_LINE1,
    A.PER_ADDRESS_2 = B.PER_ADDRESS_LINE2,
    A.PER_ADDRESS_3 = B.PER_ADDRESS_LINE3,
    A.PER_ADDRESS_4 = B.PER_ADDRESS_LINE4,
    A.PER_CITY = B.PER_CITY,
    A.PER_STATE = B.PER_STATE,
    A.PER_PIN = B.PER_PIN,
    A.PER_COUNTRY = B.PER_COUNTRY,
    A.BUS_ADDRESS_1 = B.BUS_ADDRESS_LINE1,
    A.BUS_ADDRESS_2 = B.BUS_ADDRESS_LINE2,
    A.BUS_ADDRESS_3 = B.BUS_ADDRESS_LINE3,
    A.BUS_ADDRESS_4 = B.BUS_ADDRESS_LINE4,
    A.BUS_CITY = B.BUS_CITY,
    A.BUS_STATE = B.BUS_STATE,
    A.BUS_PIN = B.BUS_PIN,
    A.BUS_COUNTRY = B.BUS_COUNTRY,
    A.MAIL_ADDRESS_1 = B.MAIL_ADDRESS_LINE1,
    A.MAIL_ADDRESS_2 = B.MAIL_ADDRESS_LINE2,
    A.MAIL_ADDRESS_3 = B.MAIL_ADDRESS_LINE3,
    A.MAIL_ADDRESS_4 = B.MAIL_ADDRESS_LINE4,
    A.MAIL_CITY = B.MAIL_CITY,
    A.MAIL_STATE = B.MAIL_STATE,
    A.MAIL_PIN = B.MAIL_PIN,
    A.MAIL_COUNTRY = B.MAIL_COUNTRY,
    A.PHONE = B.MOBILENUMBER from
    EDW.T0111_SOURCE_CUSTOMER_DETAILS_FINONE as B
    where A.SOURCE_PARTY_ID = B.SOURCE_PARTY_ID and A.SOURCE_SYSTEM_CODE = B.SOURCE_SYSTEM_CODE;
  if sqlstate <> '00000' then
    return
  end if;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.NAME_PREFIX = B.NAME_PREFIX,
    A.FULL_NAME = B.FULL_NAME,
    A.BIRTH_DATE = B.BIRTH_DATE,
    A.GENDER = B.GENDER,
    A.AGE = (case when B.BIRTH_DATE <> '1900-01-01' then DATEDIFF(yy,B.BIRTH_DATE,GETDATE()) else null end),
    A.OCCUPATION = B.PROFESSION,
    A.MARITAL_STATUS = B.MARITAL_STATUS,
    A.EMPLOYMENT_TYPE = B.EMPLOYMENT_TYPE,
    A.CUR_ADDRESS_1 = B.CUR_ADDRESS_LINE1,
    A.CUR_ADDRESS_2 = B.CUR_ADDRESS_LINE2,
    A.CUR_ADDRESS_3 = B.CUR_ADDRESS_LINE3,
    A.CUR_ADDRESS_4 = B.CUR_ADDRESS_LINE4,
    A.CUR_CITY = B.CUR_CITY,
    A.CUR_STATE = B.CUR_STATE,
    A.CUR_PIN = B.CUR_PIN,
    A.CUR_COUNTRY = B.CUR_COUNTRY,
    A.PER_ADDRESS_1 = B.PER_ADDRESS_LINE1,
    A.PER_ADDRESS_2 = B.PER_ADDRESS_LINE2,
    A.PER_ADDRESS_3 = B.PER_ADDRESS_LINE3,
    A.PER_ADDRESS_4 = B.PER_ADDRESS_LINE4,
    A.PER_CITY = B.PER_CITY,
    A.PER_STATE = B.PER_STATE,
    A.PER_PIN = B.PER_PIN,
    A.PER_COUNTRY = B.PER_COUNTRY,
    A.BUS_ADDRESS_1 = B.BUS_ADDRESS_LINE1,
    A.BUS_ADDRESS_2 = B.BUS_ADDRESS_LINE2,
    A.BUS_ADDRESS_3 = B.BUS_ADDRESS_LINE3,
    A.BUS_ADDRESS_4 = B.BUS_ADDRESS_LINE4,
    A.BUS_CITY = B.BUS_CITY,
    A.BUS_STATE = B.BUS_STATE,
    A.BUS_PIN = B.BUS_PIN,
    A.BUS_COUNTRY = B.BUS_COUNTRY,
    A.MAIL_ADDRESS_1 = B.MAIL_ADDRESS_LINE1,
    A.MAIL_ADDRESS_2 = B.MAIL_ADDRESS_LINE2,
    A.MAIL_ADDRESS_3 = B.MAIL_ADDRESS_LINE3,
    A.MAIL_ADDRESS_4 = B.MAIL_ADDRESS_LINE4,
    A.MAIL_CITY = B.MAIL_CITY,
    A.MAIL_STATE = B.MAIL_STATE,
    A.MAIL_PIN = B.MAIL_PIN,
    A.MAIL_COUNTRY = B.MAIL_COUNTRY,
    A.PHONE = B.MOBILENUMBER from
    FINAGRI.T0111_SOURCE_CUSTOMER_DETAILS as B
    where A.SOURCE_PARTY_ID = B.SOURCE_PARTY_ID and A.SOURCE_SYSTEM_CODE = B.SOURCE_SYSTEM_CODE;
  if sqlstate <> '00000' then
    return
  end if;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.NAME_PREFIX = B.NAME_PREFIX,
    A.FULL_NAME = B.FULL_NAME,
    A.BIRTH_DATE = B.BIRTH_DATE,
    A.GENDER = B.GENDER,
    A.AGE = (case when B.BIRTH_DATE <> '1900-01-01' then DATEDIFF(yy,B.BIRTH_DATE,GETDATE()) else null end),
    A.OCCUPATION = B.PROFESSION,
    A.MARITAL_STATUS = B.MARITAL_STATUS,
    A.EMPLOYMENT_TYPE = B.EMPLOYMENT_TYPE,
    A.CUR_ADDRESS_1 = B.CUR_ADDRESS_LINE1,
    A.CUR_ADDRESS_2 = B.CUR_ADDRESS_LINE2,
    A.CUR_ADDRESS_3 = B.CUR_ADDRESS_LINE3,
    A.CUR_ADDRESS_4 = B.CUR_ADDRESS_LINE4,
    A.CUR_CITY = B.CUR_CITY,
    A.CUR_STATE = B.CUR_STATE,
    A.CUR_PIN = B.CUR_PIN,
    A.CUR_COUNTRY = B.CUR_COUNTRY,
    A.PER_ADDRESS_1 = B.PER_ADDRESS_LINE1,
    A.PER_ADDRESS_2 = B.PER_ADDRESS_LINE2,
    A.PER_ADDRESS_3 = B.PER_ADDRESS_LINE3,
    A.PER_ADDRESS_4 = B.PER_ADDRESS_LINE4,
    A.PER_CITY = B.PER_CITY,
    A.PER_STATE = B.PER_STATE,
    A.PER_PIN = B.PER_PIN,
    A.PER_COUNTRY = B.PER_COUNTRY,
    A.BUS_ADDRESS_1 = B.BUS_ADDRESS_LINE1,
    A.BUS_ADDRESS_2 = B.BUS_ADDRESS_LINE2,
    A.BUS_ADDRESS_3 = B.BUS_ADDRESS_LINE3,
    A.BUS_ADDRESS_4 = B.BUS_ADDRESS_LINE4,
    A.BUS_CITY = B.BUS_CITY,
    A.BUS_STATE = B.BUS_STATE,
    A.BUS_PIN = B.BUS_PIN,
    A.BUS_COUNTRY = B.BUS_COUNTRY,
    A.MAIL_ADDRESS_1 = B.MAIL_ADDRESS_LINE1,
    A.MAIL_ADDRESS_2 = B.MAIL_ADDRESS_LINE2,
    A.MAIL_ADDRESS_3 = B.MAIL_ADDRESS_LINE3,
    A.MAIL_ADDRESS_4 = B.MAIL_ADDRESS_LINE4,
    A.MAIL_CITY = B.MAIL_CITY,
    A.MAIL_STATE = B.MAIL_STATE,
    A.MAIL_PIN = B.MAIL_PIN,
    A.MAIL_COUNTRY = B.MAIL_COUNTRY,
    A.PHONE = B.MOBILENUMBER from
    EDW.T0111_SOURCE_CUSTOMER_DETAILS_EPMS as B
    where A.SOURCE_PARTY_ID = B.SOURCE_PARTY_ID and A.SOURCE_SYSTEM_CODE = B.SOURCE_SYSTEM_CODE;
  if sqlstate <> '00000' then
    return
  end if;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.NAME_PREFIX = B.NAME_PREFIX,
    A.FULL_NAME = B.FULL_NAME,
    A.BIRTH_DATE = B.BIRTH_DATE,
    A.GENDER = B.GENDER,
    A.AGE = (case when B.BIRTH_DATE <> '1900-01-01' then DATEDIFF(yy,B.BIRTH_DATE,GETDATE()) else null end),
    A.OCCUPATION = B.PROFESSION,
    A.MARITAL_STATUS = B.MARITAL_STATUS,
    A.EMPLOYMENT_TYPE = B.EMPLOYMENT_TYPE,
    A.CUR_ADDRESS_1 = B.CUR_ADDRESS_LINE1,
    A.CUR_ADDRESS_2 = B.CUR_ADDRESS_LINE2,
    A.CUR_ADDRESS_3 = B.CUR_ADDRESS_LINE3,
    A.CUR_ADDRESS_4 = B.CUR_ADDRESS_LINE4,
    A.CUR_CITY = B.CUR_CITY,
    A.CUR_STATE = B.CUR_STATE,
    A.CUR_PIN = B.CUR_PIN,
    A.CUR_COUNTRY = B.CUR_COUNTRY,
    A.PER_ADDRESS_1 = B.PER_ADDRESS_LINE1,
    A.PER_ADDRESS_2 = B.PER_ADDRESS_LINE2,
    A.PER_ADDRESS_3 = B.PER_ADDRESS_LINE3,
    A.PER_ADDRESS_4 = B.PER_ADDRESS_LINE4,
    A.PER_CITY = B.PER_CITY,
    A.PER_STATE = B.PER_STATE,
    A.PER_PIN = B.PER_PIN,
    A.PER_COUNTRY = B.PER_COUNTRY,
    A.BUS_ADDRESS_1 = B.BUS_ADDRESS_LINE1,
    A.BUS_ADDRESS_2 = B.BUS_ADDRESS_LINE2,
    A.BUS_ADDRESS_3 = B.BUS_ADDRESS_LINE3,
    A.BUS_ADDRESS_4 = B.BUS_ADDRESS_LINE4,
    A.BUS_CITY = B.BUS_CITY,
    A.BUS_STATE = B.BUS_STATE,
    A.BUS_PIN = B.BUS_PIN,
    A.BUS_COUNTRY = B.BUS_COUNTRY,
    A.MAIL_ADDRESS_1 = B.MAIL_ADDRESS_LINE1,
    A.MAIL_ADDRESS_2 = B.MAIL_ADDRESS_LINE2,
    A.MAIL_ADDRESS_3 = B.MAIL_ADDRESS_LINE3,
    A.MAIL_ADDRESS_4 = B.MAIL_ADDRESS_LINE4,
    A.MAIL_CITY = B.MAIL_CITY,
    A.MAIL_STATE = B.MAIL_STATE,
    A.MAIL_PIN = B.MAIL_PIN,
    A.MAIL_COUNTRY = B.MAIL_COUNTRY,
    A.PHONE = B.MOBILENUMBER from
    FINAGRI.T0111_SOURCE_CUSTOMER_DETAILS_B2 as B
    where A.SOURCE_PARTY_ID = B.SOURCE_PARTY_ID and A.SOURCE_SYSTEM_CODE = B.SOURCE_SYSTEM_CODE;
  if sqlstate <> '00000' then
    return
  end if;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.NAME_PREFIX = B.NAME_PREFIX,
    A.FULL_NAME = B.FULL_NAME,
    A.BIRTH_DATE = B.BIRTH_DATE,
    A.GENDER = B.GENDER,
    A.AGE = (case when B.BIRTH_DATE <> '1900-01-01' then DATEDIFF(yy,B.BIRTH_DATE,GETDATE()) else null end),
    A.OCCUPATION = B.PROFESSION,
    A.MARITAL_STATUS = B.MARITAL_STATUS,
    A.EMPLOYMENT_TYPE = B.EMPLOYMENT_TYPE,
    A.CUR_ADDRESS_1 = B.CUR_ADDRESS_LINE1,
    A.CUR_ADDRESS_2 = B.CUR_ADDRESS_LINE2,
    A.CUR_ADDRESS_3 = B.CUR_ADDRESS_LINE3,
    A.CUR_ADDRESS_4 = B.CUR_ADDRESS_LINE4,
    A.CUR_CITY = B.CUR_CITY,
    A.CUR_STATE = B.CUR_STATE,
    A.CUR_PIN = B.CUR_PIN,
    A.CUR_COUNTRY = B.CUR_COUNTRY,
    A.PER_ADDRESS_1 = B.PER_ADDRESS_LINE1,
    A.PER_ADDRESS_2 = B.PER_ADDRESS_LINE2,
    A.PER_ADDRESS_3 = B.PER_ADDRESS_LINE3,
    A.PER_ADDRESS_4 = B.PER_ADDRESS_LINE4,
    A.PER_CITY = B.PER_CITY,
    A.PER_STATE = B.PER_STATE,
    A.PER_PIN = B.PER_PIN,
    A.PER_COUNTRY = B.PER_COUNTRY,
    A.BUS_ADDRESS_1 = B.BUS_ADDRESS_LINE1,
    A.BUS_ADDRESS_2 = B.BUS_ADDRESS_LINE2,
    A.BUS_ADDRESS_3 = B.BUS_ADDRESS_LINE3,
    A.BUS_ADDRESS_4 = B.BUS_ADDRESS_LINE4,
    A.BUS_CITY = B.BUS_CITY,
    A.BUS_STATE = B.BUS_STATE,
    A.BUS_PIN = B.BUS_PIN,
    A.BUS_COUNTRY = B.BUS_COUNTRY,
    A.MAIL_ADDRESS_1 = B.MAIL_ADDRESS_LINE1,
    A.MAIL_ADDRESS_2 = B.MAIL_ADDRESS_LINE2,
    A.MAIL_ADDRESS_3 = B.MAIL_ADDRESS_LINE3,
    A.MAIL_ADDRESS_4 = B.MAIL_ADDRESS_LINE4,
    A.MAIL_CITY = B.MAIL_CITY,
    A.MAIL_STATE = B.MAIL_STATE,
    A.MAIL_PIN = B.MAIL_PIN,
    A.MAIL_COUNTRY = B.MAIL_COUNTRY,
    A.PHONE = B.MOBILENUMBER from
    EDW.CO_APPLICANT_CUSTOMER_DETAILS_FINONE as B
    where A.SOURCE_PARTY_ID = B.SOURCE_PARTY_ID and A.SOURCE_SYSTEM_CODE = B.SOURCE_SYSTEM_CODE;
  if sqlstate <> '00000' then
    return
  end if;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.NAME_PREFIX = B.NAME_PREFIX,
    A.FULL_NAME = B.FULL_NAME,
    A.BIRTH_DATE = B.BIRTH_DATE,
    A.GENDER = B.GENDER,
    A.AGE = (case when B.BIRTH_DATE <> '1900-01-01' then DATEDIFF(yy,B.BIRTH_DATE,GETDATE()) else null end),
    A.OCCUPATION = B.PROFESSION,
    A.MARITAL_STATUS = B.MARITAL_STATUS,
    A.EMPLOYMENT_TYPE = B.EMPLOYMENT_TYPE,
    A.CUR_ADDRESS_1 = B.CUR_ADDRESS_LINE1,
    A.CUR_ADDRESS_2 = B.CUR_ADDRESS_LINE2,
    A.CUR_ADDRESS_3 = B.CUR_ADDRESS_LINE3,
    A.CUR_ADDRESS_4 = B.CUR_ADDRESS_LINE4,
    A.CUR_CITY = B.CUR_CITY,
    A.CUR_STATE = B.CUR_STATE,
    A.CUR_PIN = B.CUR_PIN,
    A.CUR_COUNTRY = B.CUR_COUNTRY,
    A.PER_ADDRESS_1 = B.PER_ADDRESS_LINE1,
    A.PER_ADDRESS_2 = B.PER_ADDRESS_LINE2,
    A.PER_ADDRESS_3 = B.PER_ADDRESS_LINE3,
    A.PER_ADDRESS_4 = B.PER_ADDRESS_LINE4,
    A.PER_CITY = B.PER_CITY,
    A.PER_STATE = B.PER_STATE,
    A.PER_PIN = B.PER_PIN,
    A.PER_COUNTRY = B.PER_COUNTRY,
    A.BUS_ADDRESS_1 = B.BUS_ADDRESS_LINE1,
    A.BUS_ADDRESS_2 = B.BUS_ADDRESS_LINE2,
    A.BUS_ADDRESS_3 = B.BUS_ADDRESS_LINE3,
    A.BUS_ADDRESS_4 = B.BUS_ADDRESS_LINE4,
    A.BUS_CITY = B.BUS_CITY,
    A.BUS_STATE = B.BUS_STATE,
    A.BUS_PIN = B.BUS_PIN,
    A.BUS_COUNTRY = B.BUS_COUNTRY,
    A.MAIL_ADDRESS_1 = B.MAIL_ADDRESS_LINE1,
    A.MAIL_ADDRESS_2 = B.MAIL_ADDRESS_LINE2,
    A.MAIL_ADDRESS_3 = B.MAIL_ADDRESS_LINE3,
    A.MAIL_ADDRESS_4 = B.MAIL_ADDRESS_LINE4,
    A.MAIL_CITY = B.MAIL_CITY,
    A.MAIL_STATE = B.MAIL_STATE,
    A.MAIL_PIN = B.MAIL_PIN,
    A.MAIL_COUNTRY = B.MAIL_COUNTRY,
    A.PHONE = B.MOBILENUMBER from
    EDW.T0111_SOURCE_CUSTOMER_DETAILS_M2I as B
    where A.SOURCE_PARTY_ID = B.SOURCE_PARTY_ID and A.SOURCE_SYSTEM_CODE = B.SOURCE_SYSTEM_CODE;
  if sqlstate <> '00000' then
    return
  end if;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.NAME_PREFIX = B.NAME_PREFIX,
    A.FULL_NAME = B.FULL_NAME,
    A.BIRTH_DATE = B.BIRTH_DATE,
    A.GENDER = B.GENDER,
    A.AGE = (case when B.BIRTH_DATE <> '1900-01-01' then DATEDIFF(yy,B.BIRTH_DATE,GETDATE()) else null end),
    A.OCCUPATION = B.PROFESSION,
    A.MARITAL_STATUS = B.MARITAL_STATUS,
    A.EMPLOYMENT_TYPE = B.EMPLOYMENT_TYPE,
    A.CUR_ADDRESS_1 = B.CUR_ADDRESS_LINE1,
    A.CUR_ADDRESS_2 = B.CUR_ADDRESS_LINE2,
    A.CUR_ADDRESS_3 = B.CUR_ADDRESS_LINE3,
    A.CUR_ADDRESS_4 = B.CUR_ADDRESS_LINE4,
    A.CUR_CITY = B.CUR_CITY,
    A.CUR_STATE = B.CUR_STATE,
    A.CUR_PIN = B.CUR_PIN,
    A.CUR_COUNTRY = B.CUR_COUNTRY,
    A.PER_ADDRESS_1 = B.PER_ADDRESS_LINE1,
    A.PER_ADDRESS_2 = B.PER_ADDRESS_LINE2,
    A.PER_ADDRESS_3 = B.PER_ADDRESS_LINE3,
    A.PER_ADDRESS_4 = B.PER_ADDRESS_LINE4,
    A.PER_CITY = B.PER_CITY,
    A.PER_STATE = B.PER_STATE,
    A.PER_PIN = B.PER_PIN,
    A.PER_COUNTRY = B.PER_COUNTRY,
    A.BUS_ADDRESS_1 = B.BUS_ADDRESS_LINE1,
    A.BUS_ADDRESS_2 = B.BUS_ADDRESS_LINE2,
    A.BUS_ADDRESS_3 = B.BUS_ADDRESS_LINE3,
    A.BUS_ADDRESS_4 = B.BUS_ADDRESS_LINE4,
    A.BUS_CITY = B.BUS_CITY,
    A.BUS_STATE = B.BUS_STATE,
    A.BUS_PIN = B.BUS_PIN,
    A.BUS_COUNTRY = B.BUS_COUNTRY,
    A.MAIL_ADDRESS_1 = B.MAIL_ADDRESS_LINE1,
    A.MAIL_ADDRESS_2 = B.MAIL_ADDRESS_LINE2,
    A.MAIL_ADDRESS_3 = B.MAIL_ADDRESS_LINE3,
    A.MAIL_ADDRESS_4 = B.MAIL_ADDRESS_LINE4,
    A.MAIL_CITY = B.MAIL_CITY,
    A.MAIL_STATE = B.MAIL_STATE,
    A.MAIL_PIN = B.MAIL_PIN,
    A.MAIL_COUNTRY = B.MAIL_COUNTRY,
    A.PHONE = B.MOBILENUMBER from
    EDW.T0111_SOURCE_CUSTOMER_DETAILS_NRISR as B
    where A.SOURCE_PARTY_ID = B.SOURCE_PARTY_ID and A.SOURCE_SYSTEM_CODE = B.SOURCE_SYSTEM_CODE;
  if sqlstate <> '00000' then
    return
  end if;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.NAME_PREFIX = B.NAME_PREFIX,
    A.FULL_NAME = B.FULL_NAME,
    A.BIRTH_DATE = B.BIRTH_DATE,
    A.GENDER = B.GENDER,
    A.AGE = (case when B.BIRTH_DATE <> '1900-01-01' then DATEDIFF(yy,B.BIRTH_DATE,GETDATE()) else null end),
    A.OCCUPATION = B.PROFESSION,
    A.MARITAL_STATUS = B.MARITAL_STATUS,
    A.EMPLOYMENT_TYPE = B.EMPLOYMENT_TYPE,
    A.CUR_ADDRESS_1 = B.CUR_ADDRESS_LINE1,
    A.CUR_ADDRESS_2 = B.CUR_ADDRESS_LINE2,
    A.CUR_ADDRESS_3 = B.CUR_ADDRESS_LINE3,
    A.CUR_ADDRESS_4 = B.CUR_ADDRESS_LINE4,
    A.CUR_CITY = B.CUR_CITY,
    A.CUR_STATE = B.CUR_STATE,
    A.CUR_PIN = B.CUR_PIN,
    A.CUR_COUNTRY = B.CUR_COUNTRY,
    A.PER_ADDRESS_1 = B.PER_ADDRESS_LINE1,
    A.PER_ADDRESS_2 = B.PER_ADDRESS_LINE2,
    A.PER_ADDRESS_3 = B.PER_ADDRESS_LINE3,
    A.PER_ADDRESS_4 = B.PER_ADDRESS_LINE4,
    A.PER_CITY = B.PER_CITY,
    A.PER_STATE = B.PER_STATE,
    A.PER_PIN = B.PER_PIN,
    A.PER_COUNTRY = B.PER_COUNTRY,
    A.BUS_ADDRESS_1 = B.BUS_ADDRESS_LINE1,
    A.BUS_ADDRESS_2 = B.BUS_ADDRESS_LINE2,
    A.BUS_ADDRESS_3 = B.BUS_ADDRESS_LINE3,
    A.BUS_ADDRESS_4 = B.BUS_ADDRESS_LINE4,
    A.BUS_CITY = B.BUS_CITY,
    A.BUS_STATE = B.BUS_STATE,
    A.BUS_PIN = B.BUS_PIN,
    A.BUS_COUNTRY = B.BUS_COUNTRY,
    A.MAIL_ADDRESS_1 = B.MAIL_ADDRESS_LINE1,
    A.MAIL_ADDRESS_2 = B.MAIL_ADDRESS_LINE2,
    A.MAIL_ADDRESS_3 = B.MAIL_ADDRESS_LINE3,
    A.MAIL_ADDRESS_4 = B.MAIL_ADDRESS_LINE4,
    A.MAIL_CITY = B.MAIL_CITY,
    A.MAIL_STATE = B.MAIL_STATE,
    A.MAIL_PIN = B.MAIL_PIN,
    A.MAIL_COUNTRY = B.MAIL_COUNTRY,
    A.PHONE = B.MOBILENUMBER from
    EDW.T0111_SOURCE_CUSTOMER_DETAILS_EXTERNAL_SYSTEM as B
    where A.SOURCE_PARTY_ID = B.SOURCE_PARTY_ID and A.SOURCE_SYSTEM_CODE = B.SOURCE_SYSTEM_CODE;
  if sqlstate <> '00000' then
    return
  end if;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.ATM_ACTIVE = 'Y' from
    MCCM.ATM_POS_CHANNEL_ATTRIBUTE as B
    where A.UCIC_VALUE = B.UCIC_CODE and LAST_TRANSACTION_ATM is not null;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.POS_ACTIVE = 'Y' from
    MCCM.ATM_POS_CHANNEL_ATTRIBUTE as B
    where A.UCIC_VALUE = B.UCIC_CODE and LAST_TRANSACTION_POS is not null;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.BRANCH_ACTIVE = 'Y' from
    MCCM.BRANCH_CHANNEL_ATTRIBUTE as B
    where A.UCIC_VALUE = B.UCIC_CODE and(B.FD_OPENED = 'Y'
    or B.RD_OPENED = 'Y'
    or B.FT_DONE = 'Y'
    or B.BP_DONE = 'Y'
    or B.PMR_DONE = 'Y'
    or B.CHEQUE_BOOK_REQUEST = 'Y'
    or B.DD = 'Y');
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.LIABILITY_ACCT_HOLDER = 'Y' from
    (select distinct UCIC_CODE from MCCM.LIABILITY_ACCT_MASTER where ACCOUNT_CLOSE_DATE is null) as B
    where A.UCIC_VALUE = B.UCIC_CODE;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.CARD_ACCT_HOLDER = 'Y' from
    (select distinct UCIC_CODE from MCCM.CARD_ACCT_MASTER where ACCOUNT_CLOSE_DATE is null) as B
    where A.UCIC_VALUE = B.UCIC_CODE;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.DEMAT_ACCT_HOLDER = 'Y' from
    (select distinct UCIC_CODE from MCCM.DEMAT_ACCT_MASTER where ACCOUNT_CLOSE_DATE is null) as B
    where A.UCIC_VALUE = B.UCIC_CODE;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.LOAN_ACCT_HOLDER = 'Y' from
    (select distinct UCIC_CODE from MCCM.LOAN_ACCT_MASTER where ACCOUNT_CLOSE_DATE is null) as B
    where A.UCIC_VALUE = B.UCIC_CODE;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.MOBILE_ACCT_HOLDER = 'Y' from
    (select distinct UCIC_CODE from MCCM.MOBILE_ACCOUNT_MASTER where ACCOUNT_CLOSE_DATE is null) as B
    where A.UCIC_VALUE = B.UCIC_CODE;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.SERVICE_REQUEST_OPEN = 'Y' from
    (select distinct UCIC_CODE from MCCM.ACCOUNT_ATTRIBUTE where SR_STATUS = 'OPEN') as B
    where A.UCIC_VALUE = B.UCIC_CODE;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.DELIVERABLE_IN_TRANSIT = 'Y' from
    (select UCIC_CODE from MCCM.ACCOUNT_ATTRIBUTE where DELIVERABLE_IN_TRANSIT in( 'Intransit','RTO Acknowledged' ) ) as B
    where A.UCIC_VALUE = B.UCIC_CODE;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.LAST_CALLCENTER_CONTACT_DATE = B.LAST_CONTACT_DATE from
    (select UCIC_CODE,MAX(LAST_CONTACT_DATE) as LAST_CONTACT_DATE from MCCM.CALLCENTER_CONTACT_DETAILS as B group by UCIC_CODE) as B
    where A.UCIC_VALUE = B.UCIC_CODE;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.SERVICE_SEGMENT = B.SERVICE_SEGMENT,
    A.INCOME_SEGMENT = B.INCOME_SEGMENT from
    (select distinct UCIC_VALUE,SERVICE_SEGMENT,INCOME_SEGMENT from P2C.UCIC_LINKAGE_TABLE_UPDATED_FINAL where TRIM(INCOME_SEGMENT) = 'GPC' and TRIM(SERVICE_SEGMENT) = 'GPC') as B
    where A.UCIC_VALUE = B.UCIC_VALUE;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.SERVICE_SEGMENT = B.SERVICE_SEGMENT,
    A.INCOME_SEGMENT = B.INCOME_SEGMENT from
    (select distinct UCIC_VALUE,SERVICE_SEGMENT,INCOME_SEGMENT from P2C.UCIC_LINKAGE_TABLE_UPDATED_FINAL where TRIM(INCOME_SEGMENT) = 'CE' and TRIM(SERVICE_SEGMENT) = 'CE') as B
    where A.UCIC_VALUE = B.UCIC_VALUE and A.SERVICE_SEGMENT is null and A.INCOME_SEGMENT is null;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.SERVICE_SEGMENT = B.SERVICE_SEGMENT,
    A.INCOME_SEGMENT = B.INCOME_SEGMENT from
    (select distinct UCIC_VALUE,SERVICE_SEGMENT,INCOME_SEGMENT from P2C.UCIC_LINKAGE_TABLE_UPDATED_FINAL where TRIM(INCOME_SEGMENT) = 'WM' and TRIM(SERVICE_SEGMENT) = 'WS') as B
    where A.UCIC_VALUE = B.UCIC_VALUE and A.SERVICE_SEGMENT is null and A.INCOME_SEGMENT is null;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.SERVICE_SEGMENT = B.SERVICE_SEGMENT,
    A.INCOME_SEGMENT = B.INCOME_SEGMENT from
    (select distinct UCIC_VALUE,SERVICE_SEGMENT,INCOME_SEGMENT from P2C.UCIC_LINKAGE_TABLE_UPDATED_FINAL where TRIM(INCOME_SEGMENT) = 'PB' and TRIM(SERVICE_SEGMENT) = 'TS') as B
    where A.UCIC_VALUE = B.UCIC_VALUE and A.SERVICE_SEGMENT is null and A.INCOME_SEGMENT is null;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.SERVICE_SEGMENT = B.SERVICE_SEGMENT,
    A.INCOME_SEGMENT = B.INCOME_SEGMENT from
    (select distinct UCIC_VALUE,SERVICE_SEGMENT,INCOME_SEGMENT from P2C.UCIC_LINKAGE_TABLE_UPDATED_FINAL where TRIM(INCOME_SEGMENT) = 'PB' and TRIM(SERVICE_SEGMENT) = 'GS') as B
    where A.UCIC_VALUE = B.UCIC_VALUE and A.SERVICE_SEGMENT is null and A.INCOME_SEGMENT is null;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.SERVICE_SEGMENT = B.SERVICE_SEGMENT,
    A.INCOME_SEGMENT = B.INCOME_SEGMENT from
    (select distinct UCIC_VALUE,SERVICE_SEGMENT,INCOME_SEGMENT from P2C.UCIC_LINKAGE_TABLE_UPDATED_FINAL where TRIM(INCOME_SEGMENT) = 'GB' and TRIM(SERVICE_SEGMENT) = 'GB') as B
    where A.UCIC_VALUE = B.UCIC_VALUE and A.SERVICE_SEGMENT is null and A.INCOME_SEGMENT is null;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.SERVICE_SEGMENT = B.SERVICE_SEGMENT,
    A.INCOME_SEGMENT = B.INCOME_SEGMENT from
    (select distinct UCIC_VALUE,SERVICE_SEGMENT,INCOME_SEGMENT from P2C.UCIC_LINKAGE_TABLE_UPDATED_FINAL where TRIM(INCOME_SEGMENT) = 'NRI' and TRIM(SERVICE_SEGMENT) = 'NRI') as B
    where A.UCIC_VALUE = B.UCIC_VALUE and A.SERVICE_SEGMENT is null and A.INCOME_SEGMENT is null;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.ACC_HOLDER = B.ACC_HOLDER from
    (select UCIC_VALUE,ACC_HOLDER,SOURCE_SYSTEM_CODE from P2C.UCIC_LINKAGE_TABLE_UPDATED_FINAL) as B
    where A.UCIC_VALUE = B.UCIC_VALUE and A.SOURCE_SYSTEM_CODE = B.SOURCE_SYSTEM_CODE;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.DELINQUENT_CUSTOMER = (case when B.COUNT >= 1 then 'Y' else 'N' end) from
    (select UCIC,COUNT(1) as COUNT from AMOLK.DELINQUENT_BASE_LB_ASSET group by UCIC) as B
    where A.UCIC_VALUE = B.UCIC;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.IMOBILE_ACTIVE = B.IMOBILE_ACTIVE from
    MCCM.IMOBILE_CHANNEL_ATTRIBUTE as B
    where A.UCIC_VALUE = B.UCIC;
  commit work;
  select distinct UCIC_CODE,SHOPPING_ACTIVE,INTERNET_ACTIVE into #UCIC_MASTER_DATA from MCCM.RIB_CHANNEL_ATTRIBUTE;
  select A.UCIC_CODE,B.SHOPPING_ACTIVE,A.INTERNET_ACTIVE into #temp_data
    from MCCM.RIB_CHANNEL_ATTRIBUTE as A,#UCIC_MASTER_DATA as B
    where A.UCIC_CODE = B.UCIC_CODE;
  if sqlstate <> '00000' then
    return
  end if;
  commit work;
  select UCIC_CODE,SHOPPING_ACTIVE,INTERNET_ACTIVE into #temp_data_1 from #temp_data
    where(SHOPPING_ACTIVE = 'Y' or INTERNET_ACTIVE = 'Y') group by UCIC_CODE,SHOPPING_ACTIVE,INTERNET_ACTIVE;
  if sqlstate <> '00000' then
    return
  end if;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.INTERNET_ACTIVE = B.INTERNET_ACTIVE from
    #temp_data_1 as B
    where A.UCIC_VALUE = B.UCIC_CODE and B.INTERNET_ACTIVE is not null;
  if sqlstate <> '00000' then
    return
  end if;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.SHOPPING_ACTIVE = B.SHOPPING_ACTIVE from
    #temp_data_1 as B
    where A.UCIC_VALUE = B.UCIC_CODE and B.SHOPPING_ACTIVE is not null;
  if sqlstate <> '00000' then
    return
  end if;
  commit work;
  ------------------------------------------------------
  select A.UNIQUE_ID,
    A.PRI_ACCT,
    A.SOURCE_SYSTEM_CODE,
    B.MODE_ID
    into #MOBILE_LIABILITY
    from EDW.BASE_PRI as A,EDW.T09527_MOBILE_ALERT_REG as B
    where A.PRI_ACCT = B.SOURCE_ACCOUNT_NBR
    and MODE_OF_DELIVERY = '0' and B.MODE_ID = 'NA'
    and A.SOURCE_SYSTEM_CODE = 30;
  if sqlstate <> '00000' then
    return
  end if;
  commit work;
  update #TEMP_UCIC_MASTER_N_SRINI as A
    set A.PHONE = B.MODE_ID from
    #MOBILE_LIABILITY as B
    where A.UCIC_VALUE = B.UNIQUE_ID
    and A.SOURCE_SYSTEM_CODE = 30;
  commit work;
  truncate table MCCM.UCIC_MASTER;
  commit work;
  insert into MCCM.UCIC_MASTER
    select UCIC_VALUE,
      NAME_PREFIX,
      FULL_NAME,
      BIRTH_DATE,
      GENDER,
      AGE,
      OCCUPATION,
      MARITAL_STATUS,
      EMPLOYMENT_TYPE,
      CUR_ADDRESS_1,
      CUR_ADDRESS_2,
      CUR_ADDRESS_3,
      CUR_ADDRESS_4,
      CUR_CITY,
      CUR_STATE,
      CUR_PIN,
      CUR_COUNTRY,
      PER_ADDRESS_1,
      PER_ADDRESS_2,
      PER_ADDRESS_3,
      PER_ADDRESS_4,
      PER_CITY,
      PER_STATE,
      PER_PIN,
      PER_COUNTRY,
      BUS_ADDRESS_1,
      BUS_ADDRESS_2,
      BUS_ADDRESS_3,
      BUS_ADDRESS_4,
      BUS_CITY,
      BUS_STATE,
      BUS_PIN,
      BUS_COUNTRY,
      MAIL_ADDRESS_1,
      MAIL_ADDRESS_2,
      MAIL_ADDRESS_3,
      MAIL_ADDRESS_4,
      MAIL_CITY,
      MAIL_STATE,
      MAIL_PIN,
      MAIL_COUNTRY,
      PHONE,
      IMOBILE_ACTIVE,
      INTERNET_ACTIVE,
      ATM_ACTIVE,
      POS_ACTIVE,
      BRANCH_ACTIVE,
      LIABILITY_ACCT_HOLDER,
      CARD_ACCT_HOLDER,
      DEMAT_ACCT_HOLDER,
      LOAN_ACCT_HOLDER,
      MOBILE_ACCT_HOLDER,
      SERVICE_REQUEST_OPEN,
      DELIVERABLE_IN_TRANSIT,
      LAST_CALLCENTER_CONTACT_DATE,
      CSM_NAME,
      CSM_EMAILID,
      CSM_NUMBER,
      RM_EMAILID,
      RM_NUMBER,
      RM_NAME,
      SERVICE_SEGMENT,
      INCOME_SEGMENT,
      CREDIT_SCORE,
      DELINQUENT_CUSTOMER,
      FRAUD_CUSTOMER_FLAG,
      AS_OF_DATE,
      ACC_HOLDER,
      POCKETS_DOWNLOADED,
      SHOPPING_ACTIVE
      from #TEMP_UCIC_MASTER_N_SRINI;
  if sqlstate <> '00000' then
    return
  end if;
  commit work;
  select distinct B.UCIC_VALUE,A.CSM_NAME,CSM_EMAIL,A.CSM_MOBILE,A.RM_EMAIL,A.RM_MOBILE,A.RM_NAME
    into #CSM_RM
    from SRCSTAGE.ICI_WM_MAP_TBL as A
      ,P2C.UCIC_LINKAGE_TABLE_UPDATED_FINAL as B
    where A.CIF_ID = B.SOURCE_PARTY_ID;
  if sqlstate <> '00000' then
    return
  end if;
  commit work;
  update MCCM.UCIC_MASTER as A
    set A.CSM_NAME = B.CSM_NAME,
    CSM_EMAILID = B.CSM_EMAIL,
    CSM_NUMBER = CSM_MOBILE,
    RM_EMAILID = B.RM_EMAIL,
    RM_NUMBER = B.RM_MOBILE,
    RM_NAME = B.RM_NAME from
    #CSM_RM as B
    where A.UCIC_CODE = B.UCIC_VALUE;
  commit work;
  select cast(null as varchar(30)) as ucic_value,
    LEADID,
    Cust_ID,
    PB_ID,
    Designation,
    Sol_ID,
    PB_Name,
    Email_ID,
    Ph_no,
    RIP_Status
    into #PB_DATA
    from ranjank.sfa_dump_v1;
  if sqlstate <> '00000' then
    return
  end if;
  commit work;
  update #PB_DATA as a
    set ucic_value = b.ucic_value from
    p2c.ucic_linkage_table_updated_final as b
    where a.Cust_ID = b.source_party_id
    and b.source_system_code = 30;
  commit work;
  update MCCM.UCIC_MASTER as A
    set RM_EMAILID = B.EMAIL_ID,
    RM_NUMBER = B.PH_NO,
    RM_NAME = B.PB_NAME from
    #PB_DATA as B
    where A.UCIC_CODE = B.UCIC_VALUE;
  commit work;
  select B.UCIC_VALUE
    into #POCKET
    from edw.main_epms_card as A
      ,(select UCIC_VALUE,SOURCE_ACCOUNT_NBR from P2C.UCIC_LINKAGE_TABLE_UPDATED_FINAL where SOURCE_SYSTEM_CODE = 90
        and SOURCE_ACCOUNT_NBR like '433662%' and length(SOURCE_ACCOUNT_NBR) = 16) as B
    where A.CARD_NUMBER = B.SOURCE_ACCOUNT_NBR
    and A.CARD_NUMBER like '433662%' and LENGTH(CARD_NUMBER) = 16 and STATUS_CODE <> 15;
  if sqlstate <> '00000' then
    return
  end if;
  commit work;
  update MCCM.UCIC_MASTER as A
    set POCKET_DOWNLOADED = 'Y' from
    #POCKET as B
    where A.UCIC_CODE = B.UCIC_VALUE;
  commit work;
  update MCCM.UCIC_MASTER as A
    set a.SHOPPING_ACTIVE = 'Y' from
    mccm.rib_channel_attribute as B
    where A.UCIC_CODE = B.UCIC_CODE
    and B.shopping_active is not null;
  commit work
end
