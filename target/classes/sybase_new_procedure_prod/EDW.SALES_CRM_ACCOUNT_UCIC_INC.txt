create procedure EDW.SALES_CRM_ACCOUNT_UCIC_INC()
begin
  declare ACC_OPEN_DATE date;
  declare ACC_CLOSE_DATE date;
  select MAX(ACCOUNTOPENINGDATE)
    into ACC_OPEN_DATE
    from P2C.CAR_CRM_ACCOUNT_UCIC where source_system_code <> 302;
  commit work;
  select MAX(ACCOUNTCLOSEDDATE) into ACC_CLOSE_DATE from P2C.CAR_CRM_ACCOUNT_UCIC where ACCOUNTCLOSEDDATE is not null;
  commit work;
  --INCREEMENTAL PARAM 2015-07-06
  --INSERT INTO P2C.CAR_CRM_ACCOUNT_UCIC_HIST SELECT *,GETDATE() FROM P2C.CAR_CRM_ACCOUNT_UCIC;
  --COMMIT;
  truncate table P2C.CAR_CRM_ACCOUNT_UCIC;
  insert into P2C.CAR_CRM_ACCOUNT_UCIC
    select A.SOURCE_ACCOUNT_NBR,
      A.UCIC_VALUE,TRIM(SOURCE_PARTY_ID),
      A.SOURCE_SYSTEM_CODE,
      A.ACCOUNT_OPEN_DATE,
      A.ACCOUNT_CLOSE_DATE,
      cast(null as varchar(50)) as BASEPRODUCT,
      cast(null as varchar(50)) as BUSINESSLINE,
      cast(null as varchar(50)) as PRODUCTCATEGORY,
      cast(null as varchar(50)) as CUST_STAT_CODE,
      cast(null as varchar(50)) as BRANCHSOLID,
      A.DORMANCY_STATUS,
      cast(null as varchar(50)) as ACCOUNTSTATUS,
      cast(null as varchar(50)) as CUST_CONST,
      A.FULL_NAME,
      A.INCOME_SEGMENT,
      A.SERVICE_SEGMENT,
      cast(null as varchar(50)) as PROFITABILITYCUSTSEG,
      A.CRITERIA,
      A.RELATION_TYPE,
      DATEFORMAT(GETDATE(),'YYYY-MM-DD') as CREATEDON,
      DATEFORMAT(GETDATE(),'YYYY-MM-DD') as MODIFIEDON,
      cast(null as varchar(30)) as OLD_UCIC_VALUE,
      B.SCHEME_CODE as SCHEME_CODE
      from P2C.UCIC_LINKAGE_TABLE_UPDATED_FINAL as A left outer join(select SOURCE_ACCOUNT_NBR,SCHEME_CODE from EDW.T0300_ACCOUNT where SOURCE_SYSTEM_CODE = 30) as B
        on A.SOURCE_ACCOUNT_NBR = B.SOURCE_ACCOUNT_NBR
      where A.SOURCE_ACCOUNT_NBR is not null
      and ISNULL(A.INCOME_SEGMENT,'A') <> 'GPC' and(ACCOUNT_OPEN_DATE > ACC_OPEN_DATE or ACCOUNT_CLOSE_DATE > ACC_CLOSE_DATE);
  -- and ISNULL(A.INCOME_SEGMENT,'A') <> 'GPC' and ACCOUNT_OPEN_DATE > '2015-07-06' or ISNULL(ACCOUNT_CLOSE_DATE,'1900-01-01') > '2015-07-06');
  commit work;
  update P2C.CAR_CRM_ACCOUNT_UCIC as A
    set A.BASEPRODUCT = (case when SCHEME_CODE = '30SAERA' then 'SAVING BANK'
    when SCHEME_CODE = '30SONRE' then 'SAVING BANK'
    when SCHEME_CODE = '30SBGEN' then 'SAVING BANK'
    when SCHEME_CODE = '30SBSTF' then 'SAVING BANK'
    when SCHEME_CODE = '30SKNRE' then 'SAVING BANK'
    when SCHEME_CODE = '30SBESY' then 'SAVING BANK'
    when SCHEME_CODE = '30SBTAS' then 'SAVING BANK'
    when SCHEME_CODE = '30FXBIL' then 'SAVING BANK'
    when SCHEME_CODE = '30SBNRE' then 'SAVING BANK'
    when SCHEME_CODE = '30SBNRO' then 'SAVING BANK'
    when SCHEME_CODE = '30SBPRU' then 'SAVING BANK'
    when SCHEME_CODE = '30SBNRS' then 'SAVING BANK'
    when SCHEME_CODE = '30SBNRF' then 'SAVING BANK'
    when SCHEME_CODE = '30SBKIT' then 'SAVING BANK'
    when SCHEME_CODE = '30SBFCR' then 'SAVING BANK'
    when SCHEME_CODE = '30SBNFR' then 'SAVING BANK'
    when SCHEME_CODE = '30SBONL' then 'SAVING BANK'
    when SCHEME_CODE = '30SBPRV' then 'SAVING BANK'
    when SCHEME_CODE = '30SBPLN' then 'SAVING BANK'
    when SCHEME_CODE = '30SBBBA' then 'SAVING BANK'
    when SCHEME_CODE = '30SBBAI' then 'SAVING BANK'
    when SCHEME_CODE = '30SBNRG' then 'SAVING BANK'
    when SCHEME_CODE = '30SBFNO' then 'SAVING BANK'
    when SCHEME_CODE = '30SBKKT' then 'SAVING BANK'
    when SCHEME_CODE = '30REUSB' then 'FC- SAVING BANK'
    when SCHEME_CODE = '30EEUSB' then 'FC- SAVING BANK'
    when SCHEME_CODE = '30RJYSB' then 'FC- SAVING BANK'
    when SCHEME_CODE = '30RDMSB' then 'FC- SAVING BANK'
    when SCHEME_CODE = '30EDMSB' then 'FC- SAVING BANK'
    when SCHEME_CODE = '30EJYSB' then 'FC- SAVING BANK'
    when SCHEME_CODE = '30EGBSB' then 'FC- SAVING BANK'
    when SCHEME_CODE = '30EUSSB' then 'FC- SAVING BANK'
    when SCHEME_CODE = '30RGBSB' then 'FC- SAVING BANK'
    when SCHEME_CODE = '30RUSSB' then 'FC- SAVING BANK'
    when SCHEME_CODE = '30RMCRI' then 'REMITTANCE CARD'
    when SCHEME_CODE = '30RMCRN' then 'REMITTANCE CARD'
    when SCHEME_CODE = '30RMCRD' then 'REMITTANCE CARD'
    when SCHEME_CODE = '30ODRBL' then 'RBC'
    when SCHEME_CODE = '30CAPOA' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30IFGLN' then 'LOAN AGAINST GOLD'
    when SCHEME_CODE = '30CADDA' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30LCINL' then 'LC'
    when SCHEME_CODE = '30MLTOD' then 'OVERDRAFT'
    when SCHEME_CODE = '30ODPPF' then 'OVERDRAFT'
    when SCHEME_CODE = '30CARSW' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CABRF' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CAIPO' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CASTF' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CAFFD' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CAGEN' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CAESY' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CANUG' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CANUE' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CANUO' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CANUS' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CANRE' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CANRO' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CAFII' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CANRS' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CABUS' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CALAS' then 'LAS'
    when SCHEME_CODE = '30CABRK' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CABMS' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CARLB' then 'LAS'
    when SCHEME_CODE = '30CAVOS' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CAROD' then 'OVERDRAFT'
    when SCHEME_CODE = '30EXNOD' then 'OVERDRAFT'
    when SCHEME_CODE = '30ODWIN' then 'OVERDRAFT'
    when SCHEME_CODE = '30ODWRF' then 'OVERDRAFT'
    when SCHEME_CODE = '30CAKIT' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CAPCM' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CAVFD' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CAMFO' then 'LAS'
    when SCHEME_CODE = '30CAMFC' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CAVAS' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CAFPI' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30HNIOD' then 'OVERDRAFT'
    when SCHEME_CODE = '30CALOD' then 'OVERDRAFT'
    when SCHEME_CODE = '30RBCOD' then 'RBC'
    when SCHEME_CODE = '30HMOAD' then 'HOME OD'
    when SCHEME_CODE = '30GCRLG' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30VDIBD' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30ODKKV' then 'KKV'
    when SCHEME_CODE = '30LCIMP' then 'LC'
    when SCHEME_CODE = '30CARBC' then 'RBC'
    when SCHEME_CODE = '30CARBL' then 'RBC'
    when SCHEME_CODE = '30RCLIM' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30ODDWC' then 'OVERDRAFT'
    when SCHEME_CODE = '30CATAS' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CAKKV' then 'KKV'
    when SCHEME_CODE = '30CAMSA' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CAFWD' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CAFCR' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CAGLA' then 'LOAN AGAINST GOLD'
    when SCHEME_CODE = '30CAGLP' then 'LOAN AGAINST GOLD'
    when SCHEME_CODE = '30CAGLN' then 'LOAN AGAINST GOLD'
    when SCHEME_CODE = '30VEHOD' then 'OVERDRAFT'
    when SCHEME_CODE = '30SBLOD' then 'BUSINESS LOANS'
    when SCHEME_CODE = '30CAHED' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30BPODL' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CAERA' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CABUL' then 'CURRENT ACCOUNT'
    when SCHEME_CODE = '30CAGLW' then 'LOAN AGAINST GOLD'
    when SCHEME_CODE = '30SALOD' then 'OVERDRAFT'
    when SCHEME_CODE = '30EECCA' then 'FC- CURRENT ACCOUNT'
    when SCHEME_CODE = '30EEUCA' then 'FC- CURRENT ACCOUNT'
    when SCHEME_CODE = '30ECACA' then 'FC- CURRENT ACCOUNT'
    when SCHEME_CODE = '30EJYCA' then 'FC- CURRENT ACCOUNT'
    when SCHEME_CODE = '30EDMCA' then 'FC- CURRENT ACCOUNT'
    when SCHEME_CODE = '30EGBCA' then 'FC- CURRENT ACCOUNT'
    when SCHEME_CODE = '30EUSCA' then 'FC- CURRENT ACCOUNT'
    when SCHEME_CODE = '30CAFUS' then 'FC- CURRENT ACCOUNT'
    when SCHEME_CODE = '30CAFGB' then 'FC- CURRENT ACCOUNT'
    when SCHEME_CODE = '30CAFDM' then 'FC- CURRENT ACCOUNT'
    when SCHEME_CODE = '30CAFJY' then 'FC- CURRENT ACCOUNT'
    when SCHEME_CODE = '30ODMCA' then 'FC- CURRENT ACCOUNT'
    when SCHEME_CODE = '30OUSCA' then 'FC- CURRENT ACCOUNT'
    when SCHEME_CODE = '30EDKCA' then 'EEFC - CA'
    when SCHEME_CODE = '30ECHCA' then 'EEFC - CA'
    when SCHEME_CODE = '30EALCA' then 'EEFC - CA'
    when SCHEME_CODE = '30SFCCA' then 'EEFC - CA'
    when SCHEME_CODE = '30ACUCA' then 'FC- CURRENT ACCOUNT'
    when SCHEME_CODE = '30RFCDP' then 'FC- CURRENT ACCOUNT'
    when SCHEME_CODE = '30CADFC' then 'FC- CURRENT ACCOUNT'
    when SCHEME_CODE = '30RIDFC' then 'FC- CURRENT ACCOUNT'
    when SCHEME_CODE = '30JH60M' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30JH60Q' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDRBO' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FD60Y' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDGEN' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FD80S' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDM80' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FTS60' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FTSST' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30JHDGM' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30JHDGQ' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30JHDSM' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDMIN' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDNRE' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDNRO' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FFS60' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FTSGN' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FTSS6' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30IBFDR' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30JHDMM' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FD80R' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30JHDMQ' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30JHDNM' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30JHDNQ' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30JHDSQ' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30JHS60' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30JTS60' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30JTSGM' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30JTSS6' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30JTSST' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDRPO' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FD10Y' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDISD' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30SMDIS' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30SFDHY' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30SFDRS' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30SMDIE' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30SFSTE' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30SFDQE' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30SFDHE' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30SFSTO' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30SFDQO' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30SFDHO' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30SZERO' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FMO80' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FQO80' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30SFBAN' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30SFDQT' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30SMDIO' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDQ80' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FD90R' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDRBR' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDRPR' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FD90G' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDCOG' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDBPI' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDBBL' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDRPS' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDISR' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDQTS' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDRBS' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDISG' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30QCORP' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDMPI' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDMSC' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDMSE' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDMSO' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDQMR' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDQME' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDMTR' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDNRD' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDRMT' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDMTE' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDRED' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDNRS' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDQMO' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDQTO' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FD90O' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDQNR' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FD3SD' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FD90N' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FD3ML' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDQTE' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDISC' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDQTR' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FD90 ' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDCON' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDISE' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDISO' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDRPI' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDRBL' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FD90S' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDISS' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDQNN' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FLFDQ' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDQRS' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDRPL' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30RFEUD' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30RFDIS' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30RFDMD' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30RFGBD' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30RFUSD' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30EFJYD' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30EFGBD' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30EFUSD' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30EFDMD' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30EFJYH' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30EFDMH' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30EFUSH' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30RFJYH' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30RFDMH' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30RFGBH' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30RFUSH' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30EFGBH' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30FCNR ' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30RFCTD' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30RCFCD' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30RFEUH' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30EFEUH' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30EFEUD' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30RFJYD' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30CFESY' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30CFDTE' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FLFDC' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30CFDEP' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30CFDEE' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30CFDEO' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30CFCRD' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30CFDOC' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30AD60Y' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30ADGEN' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30CF80C' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30CF80S' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30CFVFD' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30CFDTA' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30CFSEC' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30SCBAN' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30CF80O' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30CF80R' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30CFDER' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30CFDTY' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30CFDEG' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30CFBAN' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30CFDSR' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30CFESS' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30SCNRO' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30NSYGN' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30SCFDP' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FFDQO' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30SJYST' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30SJYNE' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30SJYGN' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30RUYST' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30RUYGN' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30RUY60' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30NSYST' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30NSYMI' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30SCNRE' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30ATS60' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30ADRMI' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30ADRST' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30ATSGN' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30CFDES' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30CFDNR' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30ADS60' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30ATSST' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDS60' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FDSTF' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FFD60' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FFDGC' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FFDGH' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FFDGN' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FFDST' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30ATSS6' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30CALBK' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30CBK14' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30FFDGM' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30ADRNE' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30ADNRO' then 'FIXED DEPOSIT'
    when SCHEME_CODE = '30TEEFQ' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30TEEFC' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30TEEGQ' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30TEEGC' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30CFEGB' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30CFRUS' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30CFRGB' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30CFRDM' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30CFRJY' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30CFEUS' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30CFEDM' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30CFEEU' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30CFEJY' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30CFDFC' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30CFREU' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30SBPPF' then 'PPF'
    when SCHEME_CODE = '30ANRDD' then 'RECURRING DEPOSIT'
    when SCHEME_CODE = '30ANCFD' then 'RECURRING DEPOSIT'
    when SCHEME_CODE = '30ANROY' then 'RECURRING DEPOSIT'
    when SCHEME_CODE = '30ANROM' then 'RECURRING DEPOSIT'
    when SCHEME_CODE = '30ANROQ' then 'RECURRING DEPOSIT'
    when SCHEME_CODE = '30ICIVR' then 'RECURRING DEPOSIT'
    when SCHEME_CODE = '30RDS60' then 'RECURRING DEPOSIT'
    when SCHEME_CODE = '30RDTAN' then 'RECURRING DEPOSIT'
    when SCHEME_CODE = '30RDFLX' then 'RECURRING DEPOSIT'
    when SCHEME_CODE = '30RDGEG' then 'RECURRING DEPOSIT'
    when SCHEME_CODE = '30RDDSR' then 'RECURRING DEPOSIT'
    when SCHEME_CODE = '30BRNRE' then 'RECURRING DEPOSIT'
    when SCHEME_CODE = '30RD60Y' then 'RECURRING DEPOSIT'
    when SCHEME_CODE = '30RDPPA' then 'RECURRING DEPOSIT'
    when SCHEME_CODE = '30BRMIN' then 'RECURRING DEPOSIT'
    when SCHEME_CODE = '30BRGEN' then 'RECURRING DEPOSIT'
    when SCHEME_CODE = '30BRSTF' then 'RECURRING DEPOSIT'
    when SCHEME_CODE = '30SRDGN' then 'RECURRING DEPOSIT'
    when SCHEME_CODE = '30RDNRS' then 'RECURRING DEPOSIT'
    when SCHEME_CODE = '30RDNRE' then 'RECURRING DEPOSIT'
    when SCHEME_CODE = '30RDNRO' then 'RECURRING DEPOSIT'
    when SCHEME_CODE = '30RDGEN' then 'RECURRING DEPOSIT'
    when SCHEME_CODE = '30SBY01' then 'RECURRING DEPOSIT'
    when SCHEME_CODE = '30SBY02' then 'RECURRING DEPOSIT'
    when SCHEME_CODE = '30FDHYR' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30CFCNE' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30FDHYG' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30CFCNR' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30CFMCD' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30SCFCN' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30MCCFD' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30CFDMC' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30FDHMC' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30FDHJY' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30FDHEU' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30CFDEU' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30FDHDM' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30FDHGB' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30FDHUS' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30CFDJY' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30CFDDM' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30CFDGB' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30CFDUS' then 'FC - FIXED DEPOSITS'
    when SCHEME_CODE = '30RBCFD' then 'BONDS'
    when SCHEME_CODE = '30RBHAL' then 'BONDS'
    when SCHEME_CODE = '30CD   ' then 'BONDS'
    when SCHEME_CODE = '30KCC01' then 'KCC'
    when SCHEME_CODE = '30KCC02' then 'KCC'
    when SCHEME_CODE = '30ODNRO' then 'OVERDRAFT'
    when SCHEME_CODE = '30ODNRE' then 'OVERDRAFT'
    when SCHEME_CODE = '30ODSTF' then 'OVERDRAFT'
    when SCHEME_CODE = '30ODNRI' then 'OVERDRAFT'
    when SCHEME_CODE = '30ODGEN' then 'OVERDRAFT'
    when SCHEME_CODE = '30CCDF2' then 'OVERDRAFT'
    when SCHEME_CODE = '30CCDF4' then 'OVERDRAFT'
    when SCHEME_CODE = '30CCGEN' then 'OVERDRAFT'
    when SCHEME_CODE = '30CCTRO' then 'OVERDRAFT'
    when SCHEME_CODE = '30CCDFE' then 'OVERDRAFT'
    when SCHEME_CODE = '30CCKS4' then 'KCC'
    when SCHEME_CODE = '30CCKS3' then 'KCC'
    when SCHEME_CODE = '30CCKSC' then 'KCC'
    when SCHEME_CODE = '30PACSS' then 'OVERDRAFT'
    when SCHEME_CODE = '30CCKCC' then 'KCC'
    when SCHEME_CODE = '30CCRBC' then 'RBC'
    when SCHEME_CODE = '30CCKC4' then 'KCC'
    when SCHEME_CODE = '30CCKC3' then 'KCC'
    when SCHEME_CODE = '30KCC04' then 'KCC'
    when SCHEME_CODE = '30KCC03' then 'KCC'
    when SCHEME_CODE = '30PCGEN' then 'BUSINESS LOANS'
    when SCHEME_CODE = '30DPSTC' then 'BUSINESS LOANS'
    when SCHEME_CODE = '30RPCGN' then 'BUSINESS LOANS'
    when SCHEME_CODE = '30RPVAR' then 'BUSINESS LOANS'
    when SCHEME_CODE = '30PCJPY' then 'BUSINESS LOANS'
    when SCHEME_CODE = '30PCDEM' then 'BUSINESS LOANS'
    when SCHEME_CODE = '30PCGBP' then 'BUSINESS LOANS'
    when SCHEME_CODE = '30EPCFC' then 'BUSINESS LOANS'
    when SCHEME_CODE = '30RPCFC' then 'BUSINESS LOANS'
    when SCHEME_CODE = '30PCUSD' then 'BUSINESS LOANS'
    when SCHEME_CODE = '30PCFOV' then 'BUSINESS LOANS'
    when SCHEME_CODE = '30IMPFS' then 'BUSINESS LOANS'
    when SCHEME_CODE = '30SGLN ' then 'DEMAND LOAN'
    when SCHEME_CODE = '30CTLGS' then 'DEMAND LOAN'
    when SCHEME_CODE = '30TLOTH' then 'DEMAND LOAN'
    when SCHEME_CODE = '30TLVAR' then 'DEMAND LOAN'
    when SCHEME_CODE = '30SLDEP' then 'DEMAND LOAN'
    when SCHEME_CODE = '30SNSC ' then 'DEMAND LOAN'
    when SCHEME_CODE = '30TLAGR' then 'DEMAND LOAN'
    when SCHEME_CODE = '30TLGOV' then 'DEMAND LOAN'
    when SCHEME_CODE = '30TLNEI' then 'DEMAND LOAN'
    when SCHEME_CODE = '30TLGEN' then 'DEMAND LOAN'
    when SCHEME_CODE = '30STLNI' then 'DEMAND LOAN'
    when SCHEME_CODE = '30STLAG' then 'DEMAND LOAN'
    when SCHEME_CODE = '30STLEI' then 'DEMAND LOAN'
    when SCHEME_CODE = '30LEASE' then 'DEMAND LOAN'
    when SCHEME_CODE = '30DLNRI' then 'DEMAND LOAN'
    when SCHEME_CODE = '30DLVAR' then 'DEMAND LOAN'
    when SCHEME_CODE = '30DLGLD' then 'DEMAND LOAN'
    when SCHEME_CODE = '30TLDEP' then 'DEMAND LOAN'
    when SCHEME_CODE = '30LASGR' then 'DEMAND LOAN'
    when SCHEME_CODE = '30BCCRD' then 'DEMAND LOAN'
    when SCHEME_CODE = '30BGDVL' then 'DEMAND LOAN'
    when SCHEME_CODE = '30DLMIB' then 'DEMAND LOAN'
    when SCHEME_CODE = '30DLOTH' then 'DEMAND LOAN'
    when SCHEME_CODE = '30EMPAA' then 'DEMAND LOAN'
    when SCHEME_CODE = '30DLGEN' then 'DEMAND LOAN'
    when SCHEME_CODE = '30FLGEN' then 'DEMAND LOAN'
    when SCHEME_CODE = '30SDLNI' then 'DEMAND LOAN'
    when SCHEME_CODE = '30SDLAG' then 'DEMAND LOAN'
    when SCHEME_CODE = '30SDLGD' then 'DEMAND LOAN'
    when SCHEME_CODE = '30LACLI' then 'DEMAND LOAN'
    when SCHEME_CODE = '30DLAGR' then 'DEMAND LOAN'
    when SCHEME_CODE = '30DRGLD' then 'DEMAND LOAN'
    when SCHEME_CODE = '30FLDGN' then 'DEMAND LOAN'
    when SCHEME_CODE = '30SDLEI' then 'DEMAND LOAN'
    when SCHEME_CODE = '30EMPPA' then 'DEMAND LOAN'
    when SCHEME_CODE = '30BPINL' then 'BILLS PURCHASED'
    when SCHEME_CODE = '30INLBP' then 'BILLS PURCHASED'
    when SCHEME_CODE = '30BPCBF' then 'BILLS PURCHASED'
    when SCHEME_CODE = '30BPWRF' then 'BILLS PURCHASED'
    when SCHEME_CODE = '30FBPTC' then 'BILLS PURCHASED'
    when SCHEME_CODE = '30FBP' then 'BILLS PURCHASED'
    when SCHEME_CODE = '30OEFBP' then 'BILLS PURCHASED'
    when SCHEME_CODE = '30OEFPB' then 'BILLS PURCHASED'
    when SCHEME_CODE = '30OIFBP' then 'BILLS PURCHASED'
    when SCHEME_CODE = '30OIBIP' then 'BILLS PURCHASED'
    when SCHEME_CODE = '30OILCB' then 'BILLS PURCHASED'
    when SCHEME_CODE = '30DLWRF' then 'BILLS PURCHASED'
    when SCHEME_CODE = '30OIBDV' then 'BILLS PURCHASED'
    when SCHEME_CODE = '30TRADE' then 'OTHERS' else null end)
    where SOURCE_SYSTEM_CODE = 30;
  commit work;
  update P2C.CAR_CRM_ACCOUNT_UCIC as A
    set A.BRANCHSOLID = B.DOMICILE_CHANNEL_ID from
    EDW.T0300_ACCOUNT as B
    where A.SOURCE_ACCOUNT_NBR = B.SOURCE_ACCOUNT_NBR
    and A.SOURCE_SYSTEM_CODE = B.SOURCE_SYSTEM_CODE;
  commit work;
  update P2C.CAR_CRM_ACCOUNT_UCIC as A
    set A.BRANCHSOLID = null where SOURCE_SYSTEM_CODE in( 20,51,52,53 ) ;
  commit work;
  insert into P2C.SALES_CRM_ACCOUNT_MASTER
    select SOURCE_ACCOUNT_NBR,UCIC_VALUE,SOURCE_PARTY_ID,SOURCE_SYSTEM_CODE,ACCOUNTOPENINGDATE,ACCOUNTCLOSEDDATE,BASEPRODUCT,
      BUSINESSLINE,PRODUCTCATEGORY,CONSTITUTIONCODE,BRANCHSOLID,DORMANCYSTATUS,ACCOUNTSTATUS,CUSTOMERTYPE,CREATEDON,MODIFIEDON
      from P2C.CAR_CRM_ACCOUNT_UCIC;
  commit work;
  update P2C.SALES_CRM_ACCOUNT_MASTER
    set BASEPRODUCT = 'CREDIT CARDS'
    where SOURCESYSTEMCODE = 20;
  commit work;
  update P2C.SALES_CRM_ACCOUNT_MASTER
    set BASEPRODUCT = 'DEMAT ACCOUNT'
    where SOURCESYSTEMCODE = 80;
  commit work;
  update P2C.SALES_CRM_ACCOUNT_MASTER
    set BASEPRODUCT = 'AGRI PRODUCTS'
    where SOURCESYSTEMCODE = 75;
  commit work;
  update P2C.SALES_CRM_ACCOUNT_MASTER
    set BASEPRODUCT = 'PREPAID CARD'
    where SOURCESYSTEMCODE = 90;
  commit work;
  update P2C.SALES_CRM_ACCOUNT_MASTER
    set BASEPRODUCT = 'B2'
    where SOURCESYSTEMCODE = 76;
  commit work;
  update P2C.SALES_CRM_ACCOUNT_MASTER
    set BASEPRODUCT = 'EBOR-DP SECURE'
    where SOURCESYSTEMCODE = 301;
  commit work;
  update P2C.SALES_CRM_ACCOUNT_MASTER
    set BASEPRODUCT = 'MOBOMONEY'
    where SOURCESYSTEMCODE = 302;
  commit work;
  update P2C.SALES_CRM_ACCOUNT_MASTER
    set BASEPRODUCT = 'MPESA'
    where SOURCESYSTEMCODE = 303;
  commit work;
  update P2C.SALES_CRM_ACCOUNT_MASTER
    set BASEPRODUCT = 'TRAVELCARD MULTI CURRENCY'
    where SOURCESYSTEMCODE = 304;
  commit work;
  update P2C.SALES_CRM_ACCOUNT_MASTER
    set BASEPRODUCT = 'TRAVELCARD SINGLE CURRENCY'
    where SOURCESYSTEMCODE = 305;
  commit work;
  update P2C.SALES_CRM_ACCOUNT_MASTER_UCIC_CHANGED
    set BASEPRODUCT = 'CREDIT CARDS'
    where SOURCESYSTEMCODE = 20;
  commit work;
  update P2C.SALES_CRM_ACCOUNT_MASTER_UCIC_CHANGED
    set BASEPRODUCT = 'DEMAT ACCOUNT'
    where SOURCESYSTEMCODE = 80;
  commit work;
  update P2C.SALES_CRM_ACCOUNT_MASTER_UCIC_CHANGED
    set BASEPRODUCT = 'AGRI PRODUCTS'
    where SOURCESYSTEMCODE = 75;
  commit work;
  update P2C.SALES_CRM_ACCOUNT_MASTER_UCIC_CHANGED
    set BASEPRODUCT = 'PREPAID CARD'
    where SOURCESYSTEMCODE = 90;
  commit work;
  update P2C.SALES_CRM_ACCOUNT_MASTER_UCIC_CHANGED
    set BASEPRODUCT = 'B2'
    where SOURCESYSTEMCODE = 76;
  commit work;
  update P2C.SALES_CRM_ACCOUNT_MASTER_UCIC_CHANGED
    set BASEPRODUCT = 'EBOR-DP SECURE'
    where SOURCESYSTEMCODE = 301;
  commit work;
  update P2C.SALES_CRM_ACCOUNT_MASTER_UCIC_CHANGED
    set BASEPRODUCT = 'MOBOMONEY'
    where SOURCESYSTEMCODE = 302;
  commit work;
  update P2C.SALES_CRM_ACCOUNT_MASTER_UCIC_CHANGED
    set BASEPRODUCT = 'MPESA'
    where SOURCESYSTEMCODE = 303;
  commit work;
  update P2C.SALES_CRM_ACCOUNT_MASTER_UCIC_CHANGED
    set BASEPRODUCT = 'TRAVELCARD MULTI CURRENCY'
    where SOURCESYSTEMCODE = 304;
  commit work;
  update P2C.SALES_CRM_ACCOUNT_MASTER_UCIC_CHANGED
    set BASEPRODUCT = 'TRAVELCARD SINGLE CURRENCY'
    where SOURCESYSTEMCODE = 305;
  commit work;
  update P2C.SALES_CRM_ACCOUNT_MASTER as A
    set A.BASEPRODUCT = (case when substr(A.accountnumber,1,2) in( 'LP','RP','WP','JP','UP','EP','LI','DI' ) then 'Personal Loan'
    when substr(A.accountnumber,1,2) in( 'LB','LH','NH','RB' ) then 'ICICI Bank-Home Loan'
    when substr(A.accountnumber,1,2) in( 'LV' ) then 'Commercial Vehicle Loan'
    when substr(A.accountnumber,1,2) = 'UV' then 'Commercial Vehicle Loan'
    when substr(A.accountnumber,1,2) = 'LA' then 'New Car Loan'
    when substr(A.accountnumber,1,2) = 'LU' then 'Used Car Loan'
    when substr(A.accountnumber,1,2) in( 'LK','LT','BT' ) then 'Two Wheeler Loan'
    else 'Others'
    end) where SOURCESYSTEMCODE in( 53,52,51 ) ;
  commit work;
  update P2C.SALES_CRM_ACCOUNT_MASTER
    set BASEPRODUCT = 'OTHERS'
    where BASEPRODUCT is null;
  commit work;
  update P2C.SALES_CRM_ACCOUNT_MASTER as A
    set ACCOUNTSTATUS = B.CUST_STAT_CODE,
    CONSTITUTIONCODE = b.cust_const,
    customertype = (case when TRIM(b.product_type) = 'CA' then 'CA' else b.customer_type end) from
    EDW.T09311_LIABILITY_ACCOUNT_ADDON as B
    where A.ACCOUNTNUMBER = B.SOURCE_ACCOUNT_NBR
    and A.SOURCESYSTEMCODE = B.SOURCE_SYSTEM_CODE;
  commit work;
  delete from P2C.SALES_CRM_ACCOUNT_MASTER as A from
    P2C.SALES_CRM_ACCOUNT_MASTER as A
    ,(select MAX(ROWID(SALES_CRM_ACCOUNT_MASTER)) as ROW_ID,
      ACCOUNTNUMBER,CUSTID,SOURCESYSTEMCODE from P2C.SALES_CRM_ACCOUNT_MASTER
      group by ACCOUNTNUMBER,CUSTID,SOURCESYSTEMCODE) as B
    where A.ACCOUNTNUMBER = B.ACCOUNTNUMBER
    and A.CUSTID = B.CUSTID
    and A.SOURCESYSTEMCODE = B.SOURCESYSTEMCODE
    and ROWID(A) <> B.ROW_ID;
  commit work
end
