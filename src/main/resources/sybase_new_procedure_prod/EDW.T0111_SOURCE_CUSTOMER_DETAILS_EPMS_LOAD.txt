create procedure EDW.T0111_SOURCE_CUSTOMER_DETAILS_EPMS_LOAD()
begin
  truncate table EDW.T0111_SOURCE_CUSTOMER_DETAILS_EPMS;
  commit work;
  insert into EDW.T0111_SOURCE_CUSTOMER_DETAILS_EPMS
    select B.CARD_NUMBER as SOURCE_PARTY_ID,90 as SOURCE_SYSTEM_CODE,null as PARTY_ID,null as PARTY_START_DATE,null as PARTY_END_DATE,SOCIAL_STATUS as IND_ORG_CODE,
      (case when A.TITLE = '1' then 'Mr.' when A.TITLE = '2' then 'Mrs.' when A.TITLE = '3' then 'Miss.' when A.TITLE = '4' then 'Dr.'
      when A.TITLE = '5' then 'Chief' when A.TITLE = '6' then 'Sir' when A.TITLE = '7' then 'Ms' end) as NAME_PREFIX,
      A.FIRST_NAME as FIRST_NAME,A.MIDDLE_NAME as MIDDLE_NAME,A.FAMILY_NAME as LAST_NAME,A.FIRST_NAME || ' ' || A.MIDDLE_NAME || ' ' || A.FAMILY_NAME as FULL_NAME,A.BIRTH_DATE as BIRTH_DATE,
      null as DEATH_DATE,
      SEX as GENDER,(case when Family_Status = '1' then 'S' else 'M' end) as MARITAL_STATUS,null as BASIC_QUALIFICATION,null as PROF_QUALIFICATION,
      NATIONALITY_CODE as NATIONALITY,null as PROFESSION,null as EMPLOYMENT_TYPE,null as RELIGION,null as TOT_YRS_OF_EXPERIENCE,PRESENT_DESIGNATION as DESIGNATION,
      null as SALARY,null as MINOR_FLG,EMPLOYER as CUS_EMPLOYER,null as EMPLOYEE_ID,(case when Legal_identification_type = '04' then legal_id end) as DRIVERS_LICENSE_ID,
      null as VOTERS_ID,(case when Legal_identification_type = '01' then legal_id end) as PASSPORT_NBR,
      (case when Legal_identification_type = '03' then legal_id end) as PAN_NBR,null as TAX_CATEGORY,null as SHAREHOLDING,NET_YEARLY_INCOME as NET_ANNUAL_INCOME,
      EMPLOYMENT_STATUS as EMPLOYMENT_STATUS,null as GROSS_ANNUAL_INCOME,CHILDREN_NUMBER as NO_OF_CHILDREN,NO_OF_DEPENDENTS as NO_OF_DEPENDANTS,
      null as TYPE_OF_CAR_OWNED,null as RESIDENTIAL_STATUS,null as HOUSE_OWNERSHIP_TYPE,null as SPECIAL_CATEGORY,A.BANK_CODE as BANK_NBR,null as SIC_CODE,
      null as BUSI_TURNOVER,null as NO_OF_EMPLOYEES,null as ROLE_CD,EMPL_ADDRESS1 as BUS_ADDRESS_LINE1,EMPL_ADDRESS2 as BUS_ADDRESS_LINE2,EMPL_ADDRESS3 as BUS_ADDRESS_LINE3,
      EMPL_ADDRESS4 as BUS_ADDRESS_LINE4,EMPL_CITY_CODE as BUS_CITY,null as BUS_STATE,EMPL_ZIP_CODE as BUS_PIN,
      (case when EMPL_COUNTRY_CODE = '356' then 'INDIA' when EMPL_COUNTRY_CODE is null then ' ' else 'OTHERS' end) as BUS_COUNTRY,
      PHONE_OFFICE as BUSPHONE1,PHONE2_OFFICE as BUSPHONE2,A.MAILING_ADDRESS1 as PER_ADDRESS_LINE1,A.MAILING_ADDRESS2 as PER_ADDRESS_LINE2,A.MAILING_ADDRESS3 as PER_ADDRESS_LINE3,
      A.MAILING_ADDRESS4 as PER_ADDRESS_LINE4,A.MAILING_CITY_CODE as PER_CITY,null as PER_STATE,A.MAILING_ZIP_CODE as PER_PIN,
      (case when A.MAILING_COUNTRY_CODE = '356' then 'INDIA' when A.MAILING_COUNTRY_CODE is null then ' ' else 'OTHERS' end) as PER_COUNTRY,
      PHONE2_PERMANENT as PERPHONE1,MAILING_ADDRESS_PHONE2 as PERPHONE2,CURR_ADDRESS1 as MAIL_ADDRESS_LINE1,CURR_ADDRESS2 as MAIL_ADDRESS_LINE2,CURR_ADDRESS3 as MAIL_ADDRESS_LINE3,
      CURR_ADDRESS4 as MAIL_ADDRESS_LINE4,CURR_CITY_CODE as MAIL_CITY,null as MAIL_STATE,CURR_ZIP_CODE as MAIL_PIN,
      (case when CURR_COUNTRY_CODE = '356' then 'INDIA' when CURR_COUNTRY_CODE is null then ' ' else 'OTHERS' end) as MAIL_COUNTRY,
      CONTACT_PHONE1 as MAILPHONE1,CONTACT_PHONE2 as MAILPHONE2,A.ADDRESS1 as CUR_ADDRESS_LINE1,A.ADDRESS2 as CUR_ADDRESS_LINE2,A.ADDRESS3 as CUR_ADDRESS_LINE3,
      A.ADDRESS4 as CUR_ADDRESS_LINE4,A.CITY_CODE as CUR_CITY,null as CUR_STATE,A.ZIP_CODE as CUR_PIN,
      (case when A.COUNTRY_CODE = '356' then 'INDIA' when A.COUNTRY_CODE is null then ' ' else 'OTHERS' end) as CUR_COUNTRY,
      A.PHONE_HOME as CURPHONE1,A.PHONE_ALTERNATE as CURPHONE2,A.EMAIL_ID as EADDRESS,null as FAXNUMBER,A.PHONE_MOBILE as MOBILENUMBER,null as POSTAL_BOX_NBR,
      null as POBOX_DESCRIPTION,null as VEHICLE_OWNERSHIP,null as APP_OFF_STDCODE,OFFICE_EXT as APP_OFF_EXTNO,null as APP_TEMP_STDCODE,
      null as INSTITUTION_TYPE,null as CUS_DATE_LAST_ADDR_CHNG,null as NATURE_OF_OWNERSHIP,getdate() as DATE_CREATED,cast(null as date) as DATE_LAST_MODIFIED,
      DATE_CREATE as SRC_CREATED_ON,A.DATE_MODIF as SRC_MODIFIED_ON,A.USER_CREATE as SRC_CREATED_BY,A.USER_MODIF as SRC_MODIFIED_BY,null as RESIDENTIAL_LANDMARK,
      null as OFFICE_LANDMARK,null as UPLOAD_BATCH_NO,null as REMARKS,null as LEAD_FLAG,cast(MAILING_ADDRESS_TENUR as varchar(15)) as YRS_AT_CURR_RESI,null as DEPARTMENT,
      null as SOURCE_OF_LEAD,null as PASSPORT_ISSUE_DATE,OFFICE_EMAIL as BUS_EADDRESS,A.OFFICE_MOBILE as BUS_MOBILENUMBER,null as PER_EADDRESS,
      null as PER_MOBILENUMBER,null as MAIL_EADDRESS,null as MAIL_MOBILENUMBER,PREFFERED_EMAIL as CUR_EADDRESS,CONTACT_PHONE1 as CUR_MOBILENUMBER,Relationship_id
      from edw.main_epms_client as A,edw.main_epms_card as B
      where A.CLIENT_CODE = B.CLIENT_CODE;
  commit work
end
