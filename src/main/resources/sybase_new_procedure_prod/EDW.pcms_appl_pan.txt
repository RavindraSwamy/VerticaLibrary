create procedure EDW.pcms_appl_pan()
begin
  create table #UPS_MAIN_PCMS_APPL_PAN(
    CAP_PAN_CODE_ENCR varchar(50) null,
    SYB_CAP_PAN_CODE_ENCR varchar(50) null,
    );
  truncate table EDW.S_MAIN_PCMS_APPL_PAN;
  load into table EDW.S_MAIN_PCMS_APPL_PAN( CAP_APPL_CODE '|^|' null(zeros,'NULL','null'),CAP_INST_CODE '|^|' null(zeros,'NULL','null'),CAP_ASSO_CODE '|^|' null(zeros,'NULL','null'),CAP_INST_TYPE '|^|' null(zeros,'NULL','null'),CAP_PROD_CODE '|^|' null(zeros,'NULL','null'),CAP_PROD_CATG '|^|' null(zeros,'NULL','null'),CAP_CARD_TYPE '|^|' null(zeros,'NULL','null'),CAP_CUST_CATG '|^|' null(zeros,'NULL','null'),CAP_PAN_CODE '|^|' null(zeros,'NULL','null'),CAP_MBR_NUMB '|^|' null(zeros,'NULL','null'),CAP_CARD_STAT '|^|' null(zeros,'NULL','null'),CAP_PIN_OFF '|^|' null(zeros,'NULL','null'),CAP_LIMIT_IND '|^|' null(zeros,'NULL','null'),CAP_CUST_CODE '|^|' null(zeros,'NULL','null'),CAP_DISP_NAME '|^|' null(zeros,'NULL','null'),CAP_LIMIT_AMT '|^|' null(zeros,'NULL','null'),CAP_USE_LIMIT '|^|' null(zeros,'NULL','null'),CAP_APPL_BRAN '|^|' null(zeros,'NULL','null'),CAP_ACTIVE_DATE '|^|' null(zeros,'NULL','null'),CAP_EXPRY_DATE '|^|' null(zeros,'NULL','null'),CAP_ADDON_STAT '|^|' null(zeros,'NULL','null'),CAP_ADDON_LINK '|^|' null(zeros,'NULL','null'),CAP_MBR_LINK '|^|' null(zeros,'NULL','null'),CAP_ACCT_ID '|^|' null(zeros,'NULL','null'),CAP_ACCT_NO '|^|' null(zeros,'NULL','null'),CAP_TOT_ACCT '|^|' null(zeros,'NULL','null'),CAP_BILL_ADDR '|^|' null(zeros,'NULL','null'),CAP_CHNL_CODE '|^|' null(zeros,'NULL','null'),CAP_PANGEN_DATE '|^|' null(zeros,'NULL','null'),CAP_PANGEN_USER '|^|' null(zeros,'NULL','null'),CAP_CAFGEN_FLAG '|^|' null(zeros,'NULL','null'),CAP_CAF_FNAME '|^|' null(zeros,'NULL','null'),CAP_CAFGEN_DATE '|^|' null(zeros,'NULL','null'),CAP_CAFGEN_USER '|^|' null(zeros,'NULL','null'),CAP_PBFGEN_FLAG '|^|' null(zeros,'NULL','null'),CAP_PBF_FNAME '|^|' null(zeros,'NULL','null'),CAP_PBFGEN_DATE '|^|' null(zeros,'NULL','null'),CAP_PBFGEN_USER '|^|' null(zeros,'NULL','null'),CAP_PIN_FLAG '|^|' null(zeros,'NULL','null'),CAP_PINGEN_DATE '|^|' null(zeros,'NULL','null'),CAP_PINGEN_USER '|^|' null(zeros,'NULL','null'),CAP_EMBOS_FLAG '|^|' null(zeros,'NULL','null'),CAP_EMB_FNAME '|^|' null(zeros,'NULL','null'),CAP_EMBOS_DATE '|^|' null(zeros,'NULL','null'),CAP_EMBOS_USER '|^|' null(zeros,'NULL','null'),CAP_PHY_EMBOS '|^|' null(zeros,'NULL','null'),CAP_DISP_REF '|^|' null(zeros,'NULL','null'),CAP_JOIN_FEECALC '|^|' null(zeros,'NULL','null'),CAP_NEXT_BILL_DATE '|^|' null(zeros,'NULL','null'),CAP_LASTPOS_TRANDATE '|^|' null(zeros,'NULL','null'),CAP_INS_USER '|^|' null(zeros,'NULL','null'),CAP_INS_DATE '|^|' null(zeros,'NULL','null'),CAP_LUPD_USER '|^|' null(zeros,'NULL','null'),CAP_LUPD_DATE '|^|' null(zeros,'NULL','null'),CAP_SYNC_FLAG '|^|' null(zeros,'NULL','null'),CAP_ATM_OFFLINE_LIMIT '|^|' null(zeros,'NULL','null'),CAP_ATM_ONLINE_LIMIT '|^|' null(zeros,'NULL','null'),CAP_POS_OFFLINE_LIMIT '|^|' null(zeros,'NULL','null'),CAP_POS_ONLINE_LIMIT '|^|' null(zeros,'NULL','null'),CAP_OFFLINE_AGGR_LIMIT '|^|' null(zeros,'NULL','null'),CAP_ONLINE_AGGR_LIMIT '|^|' null(zeros,'NULL','null'),FLAG '|^|' null(zeros,'NULL','null'),CAP_BILLDATE_FLAG '|^|' null(zeros,'NULL','null'),CAP_NEXT_MB_DATE '|^|' null(zeros,'NULL','null'),CAP_FEE_CALC '|^|' null(zeros,'NULL','null'),CAP_ISSUE_FLAG '|^|' null(zeros,'NULL','null'),CAP_REQUEST_ID '|^|' null(zeros,'NULL','null'),CAP_RULE_INDICATOR '|^|' null(zeros,'NULL','null'),CAP_RULEGROUP_CODE '|^|' null(zeros,'NULL','null'),CAP_EMB_BATCHNO '|^|' null(zeros,'NULL','null'),CAP_IPIN_OFFSET '|^|' null(zeros,'NULL','null'),CAP_EMP_ID '|^|' null(zeros,'NULL','null'),CAP_FIRSTTIME_TOPUP '|^|' null(zeros,'NULL','null'),CAP_INV_FLAG '|^|' null(zeros,'NULL','null'),CAP_PANMAST_PARAM1 '|^|' null(zeros,'NULL','null'),CAP_PANMAST_PARAM2 '|^|' null(zeros,'NULL','null'),CAP_PANMAST_PARAM3 '|^|' null(zeros,'NULL','null'),CAP_PANMAST_PARAM4 '|^|' null(zeros,'NULL','null'),CAP_PANMAST_PARAM5 '|^|' null(zeros,'NULL','null'),CAP_PANMAST_PARAM6 '|^|' null(zeros,'NULL','null'),CAP_PANMAST_PARAM7 '|^|' null(zeros,'NULL','null'),CAP_PANMAST_PARAM8 '|^|' null(zeros,'NULL','null'),CAP_PANMAST_PARAM9 '|^|' null(zeros,'NULL','null'),CAP_PANMAST_PARAM10 '|^|' null(zeros,'NULL','null'),CAP_IKIT_FLAG '|^|' null(zeros,'NULL','null'),CAP_PAN_CODE_ENCR '|^|' null(zeros,'NULL','null'),CAP_ECOM_ONLINE_LIMIT '|^|' null(zeros,'NULL','null'),CAP_ECOM_OFFLINE_LIMIT '|^|' null(zeros,'NULL','null'),CAP_PROXY_numeric '|^|' null(zeros,'NULL','null'),CAP_MMPOS_ONLINE_LIMIT '|^|' null(zeros,'NULL','null'),CAP_MMPOS_OFFLINE_LIMIT '|^|' null(zeros,'NULL','null'),CAP_STARTERCARD_FLAG '|^|' null(zeros,'NULL','null'),CAP_SERIAL_numeric '|^|' null(zeros,'NULL','null'),CAP_INACTIVE_FEECALC_DATE '|^|' null(zeros,'NULL','null'),CAP_PRFL_CODE '|^|' null(zeros,'NULL','null'),CAP_PRFL_LEVL '|^|' null(zeros,'NULL','null'),CAP_MASK_PAN '|^|' null(zeros,'NULL','null'),PAN_BIN '|^|' null(zeros,'NULL','null'),CAP_PROXY_MSG '|^|' null(zeros,'NULL','null'),CAP_REPL_FLAG '|^|' null(zeros,'NULL','null'),CAP_NEXT_WB_DATE '|^|' null(zeros,'NULL','null'),CAP_WALT_ID '|^|' null(zeros,'NULL','null'),CAP_IBAN_ID '|^|' null(zeros,'NULL','null'),CAP_EMBOSS_LINE4 '|^|' null(zeros,'NULL','null'),CAP_TRAVEL_PURPOSE '|^|' null(zeros,'NULL','null'),CAP_ORDER_RCPT_FLG '|^|' null(zeros,'NULL','null'),CAP_CORPORATE_ID '|^|' null(zeros,'NULL','null'),CAP_FNC_ACTIVE_DATE '|^|' null(zeros,'NULL','null'),CAP_FNC_CLOSURE_DATE '|^|' null(zeros,'NULL','null'),CAP_FORFEITURE_DATE '|^|' null(zeros,'NULL','null'),CAP_NEXT_ANL_DATE '|^|' null(zeros,'NULL','null'),CAP_CORPFEE_FLAG '|^|' null(zeros,'NULL','null'),CAP_EMBOSS_LINE3 '\x0A' null(zeros,'NULL','null') ) using file
    '/sybase_load/LOAD_MANAGEMENT/EPMS/ACCOUNT/YET_TO_LOAD_FILES/cms_appl_pan.out' quotes off escapes off preview on message log '/sybase_load/LOAD_MANAGEMENT/EPMS/ACCOUNT/LOAD_LOGS/ERROR_RECORDS_MSSG/cms_appl_pan.out_201508261804.msg' row log '/sybase_load/LOAD_MANAGEMENT/EPMS/ACCOUNT/LOAD_LOGS/ERROR_RECORDS_DATA/cms_appl_pan.out_201508261804.row' only log all log delimited by '|^|' notify 100000 with checkpoint on;
  delete from EDW.S_MAIN_PCMS_APPL_PAN as A from
    EDW.S_MAIN_PCMS_APPL_PAN as A
    ,(select MAX(ROWID(S_MAIN_PCMS_APPL_PAN)) as ROW_ID,
      CAP_PAN_CODE_ENCR from EDW.S_MAIN_PCMS_APPL_PAN
      group by CAP_PAN_CODE_ENCR) as B
    where A.CAP_PAN_CODE_ENCR = B.CAP_PAN_CODE_ENCR
    and ROWID(A) <> B.ROW_ID;
  update EDW.MAIN_PCMS_APPL_PAN
    set MAIN_PCMS_APPL_PAN.CAP_APPL_CODE = S_MAIN_PCMS_APPL_PAN.CAP_APPL_CODE,
    MAIN_PCMS_APPL_PAN.CAP_INST_CODE = S_MAIN_PCMS_APPL_PAN.CAP_INST_CODE,
    MAIN_PCMS_APPL_PAN.CAP_ASSO_CODE = S_MAIN_PCMS_APPL_PAN.CAP_ASSO_CODE,
    MAIN_PCMS_APPL_PAN.CAP_INST_TYPE = S_MAIN_PCMS_APPL_PAN.CAP_INST_TYPE,
    MAIN_PCMS_APPL_PAN.CAP_PROD_CODE = S_MAIN_PCMS_APPL_PAN.CAP_PROD_CODE,
    MAIN_PCMS_APPL_PAN.CAP_PROD_CATG = S_MAIN_PCMS_APPL_PAN.CAP_PROD_CATG,
    MAIN_PCMS_APPL_PAN.CAP_CARD_TYPE = S_MAIN_PCMS_APPL_PAN.CAP_CARD_TYPE,
    MAIN_PCMS_APPL_PAN.CAP_CUST_CATG = S_MAIN_PCMS_APPL_PAN.CAP_CUST_CATG,
    MAIN_PCMS_APPL_PAN.CAP_PAN_CODE = S_MAIN_PCMS_APPL_PAN.CAP_PAN_CODE,
    MAIN_PCMS_APPL_PAN.CAP_MBR_NUMB = S_MAIN_PCMS_APPL_PAN.CAP_MBR_NUMB,
    MAIN_PCMS_APPL_PAN.CAP_CARD_STAT = S_MAIN_PCMS_APPL_PAN.CAP_CARD_STAT,
    MAIN_PCMS_APPL_PAN.CAP_PIN_OFF = S_MAIN_PCMS_APPL_PAN.CAP_PIN_OFF,
    MAIN_PCMS_APPL_PAN.CAP_LIMIT_IND = S_MAIN_PCMS_APPL_PAN.CAP_LIMIT_IND,
    MAIN_PCMS_APPL_PAN.CAP_CUST_CODE = S_MAIN_PCMS_APPL_PAN.CAP_CUST_CODE,
    MAIN_PCMS_APPL_PAN.CAP_DISP_NAME = S_MAIN_PCMS_APPL_PAN.CAP_DISP_NAME,
    MAIN_PCMS_APPL_PAN.CAP_LIMIT_AMT = S_MAIN_PCMS_APPL_PAN.CAP_LIMIT_AMT,
    MAIN_PCMS_APPL_PAN.CAP_USE_LIMIT = S_MAIN_PCMS_APPL_PAN.CAP_USE_LIMIT,
    MAIN_PCMS_APPL_PAN.CAP_APPL_BRAN = S_MAIN_PCMS_APPL_PAN.CAP_APPL_BRAN,
    MAIN_PCMS_APPL_PAN.CAP_ACTIVE_DATE = S_MAIN_PCMS_APPL_PAN.CAP_ACTIVE_DATE,
    MAIN_PCMS_APPL_PAN.CAP_EXPRY_DATE = S_MAIN_PCMS_APPL_PAN.CAP_EXPRY_DATE,
    MAIN_PCMS_APPL_PAN.CAP_ADDON_STAT = S_MAIN_PCMS_APPL_PAN.CAP_ADDON_STAT,
    MAIN_PCMS_APPL_PAN.CAP_ADDON_LINK = S_MAIN_PCMS_APPL_PAN.CAP_ADDON_LINK,
    MAIN_PCMS_APPL_PAN.CAP_MBR_LINK = S_MAIN_PCMS_APPL_PAN.CAP_MBR_LINK,
    MAIN_PCMS_APPL_PAN.CAP_ACCT_ID = S_MAIN_PCMS_APPL_PAN.CAP_ACCT_ID,
    MAIN_PCMS_APPL_PAN.CAP_ACCT_NO = S_MAIN_PCMS_APPL_PAN.CAP_ACCT_NO,
    MAIN_PCMS_APPL_PAN.CAP_TOT_ACCT = S_MAIN_PCMS_APPL_PAN.CAP_TOT_ACCT,
    MAIN_PCMS_APPL_PAN.CAP_BILL_ADDR = S_MAIN_PCMS_APPL_PAN.CAP_BILL_ADDR,
    MAIN_PCMS_APPL_PAN.CAP_CHNL_CODE = S_MAIN_PCMS_APPL_PAN.CAP_CHNL_CODE,
    MAIN_PCMS_APPL_PAN.CAP_PANGEN_DATE = S_MAIN_PCMS_APPL_PAN.CAP_PANGEN_DATE,
    MAIN_PCMS_APPL_PAN.CAP_PANGEN_USER = S_MAIN_PCMS_APPL_PAN.CAP_PANGEN_USER,
    MAIN_PCMS_APPL_PAN.CAP_CAFGEN_FLAG = S_MAIN_PCMS_APPL_PAN.CAP_CAFGEN_FLAG,
    MAIN_PCMS_APPL_PAN.CAP_CAF_FNAME = S_MAIN_PCMS_APPL_PAN.CAP_CAF_FNAME,
    MAIN_PCMS_APPL_PAN.CAP_CAFGEN_DATE = S_MAIN_PCMS_APPL_PAN.CAP_CAFGEN_DATE,
    MAIN_PCMS_APPL_PAN.CAP_CAFGEN_USER = S_MAIN_PCMS_APPL_PAN.CAP_CAFGEN_USER,
    MAIN_PCMS_APPL_PAN.CAP_PBFGEN_FLAG = S_MAIN_PCMS_APPL_PAN.CAP_PBFGEN_FLAG,
    MAIN_PCMS_APPL_PAN.CAP_PBF_FNAME = S_MAIN_PCMS_APPL_PAN.CAP_PBF_FNAME,
    MAIN_PCMS_APPL_PAN.CAP_PBFGEN_DATE = S_MAIN_PCMS_APPL_PAN.CAP_PBFGEN_DATE,
    MAIN_PCMS_APPL_PAN.CAP_PBFGEN_USER = S_MAIN_PCMS_APPL_PAN.CAP_PBFGEN_USER,
    MAIN_PCMS_APPL_PAN.CAP_PIN_FLAG = S_MAIN_PCMS_APPL_PAN.CAP_PIN_FLAG,
    MAIN_PCMS_APPL_PAN.CAP_PINGEN_DATE = S_MAIN_PCMS_APPL_PAN.CAP_PINGEN_DATE,
    MAIN_PCMS_APPL_PAN.CAP_PINGEN_USER = S_MAIN_PCMS_APPL_PAN.CAP_PINGEN_USER,
    MAIN_PCMS_APPL_PAN.CAP_EMBOS_FLAG = S_MAIN_PCMS_APPL_PAN.CAP_EMBOS_FLAG,
    MAIN_PCMS_APPL_PAN.CAP_EMB_FNAME = S_MAIN_PCMS_APPL_PAN.CAP_EMB_FNAME,
    MAIN_PCMS_APPL_PAN.CAP_EMBOS_DATE = S_MAIN_PCMS_APPL_PAN.CAP_EMBOS_DATE,
    MAIN_PCMS_APPL_PAN.CAP_EMBOS_USER = S_MAIN_PCMS_APPL_PAN.CAP_EMBOS_USER,
    MAIN_PCMS_APPL_PAN.CAP_PHY_EMBOS = S_MAIN_PCMS_APPL_PAN.CAP_PHY_EMBOS,
    MAIN_PCMS_APPL_PAN.CAP_DISP_REF = S_MAIN_PCMS_APPL_PAN.CAP_DISP_REF,
    MAIN_PCMS_APPL_PAN.CAP_JOIN_FEECALC = S_MAIN_PCMS_APPL_PAN.CAP_JOIN_FEECALC,
    MAIN_PCMS_APPL_PAN.CAP_NEXT_BILL_DATE = S_MAIN_PCMS_APPL_PAN.CAP_NEXT_BILL_DATE,
    MAIN_PCMS_APPL_PAN.CAP_LASTPOS_TRANDATE = S_MAIN_PCMS_APPL_PAN.CAP_LASTPOS_TRANDATE,
    MAIN_PCMS_APPL_PAN.CAP_INS_USER = S_MAIN_PCMS_APPL_PAN.CAP_INS_USER,
    MAIN_PCMS_APPL_PAN.CAP_INS_DATE = S_MAIN_PCMS_APPL_PAN.CAP_INS_DATE,
    MAIN_PCMS_APPL_PAN.CAP_LUPD_USER = S_MAIN_PCMS_APPL_PAN.CAP_LUPD_USER,
    MAIN_PCMS_APPL_PAN.CAP_LUPD_DATE = S_MAIN_PCMS_APPL_PAN.CAP_LUPD_DATE,
    MAIN_PCMS_APPL_PAN.CAP_SYNC_FLAG = S_MAIN_PCMS_APPL_PAN.CAP_SYNC_FLAG,
    MAIN_PCMS_APPL_PAN.CAP_ATM_OFFLINE_LIMIT = S_MAIN_PCMS_APPL_PAN.CAP_ATM_OFFLINE_LIMIT,
    MAIN_PCMS_APPL_PAN.CAP_ATM_ONLINE_LIMIT = S_MAIN_PCMS_APPL_PAN.CAP_ATM_ONLINE_LIMIT,
    MAIN_PCMS_APPL_PAN.CAP_POS_OFFLINE_LIMIT = S_MAIN_PCMS_APPL_PAN.CAP_POS_OFFLINE_LIMIT,
    MAIN_PCMS_APPL_PAN.CAP_POS_ONLINE_LIMIT = S_MAIN_PCMS_APPL_PAN.CAP_POS_ONLINE_LIMIT,
    MAIN_PCMS_APPL_PAN.CAP_OFFLINE_AGGR_LIMIT = S_MAIN_PCMS_APPL_PAN.CAP_OFFLINE_AGGR_LIMIT,
    MAIN_PCMS_APPL_PAN.CAP_ONLINE_AGGR_LIMIT = S_MAIN_PCMS_APPL_PAN.CAP_ONLINE_AGGR_LIMIT,
    MAIN_PCMS_APPL_PAN.FLAG = S_MAIN_PCMS_APPL_PAN.FLAG,
    MAIN_PCMS_APPL_PAN.CAP_BILLDATE_FLAG = S_MAIN_PCMS_APPL_PAN.CAP_BILLDATE_FLAG,
    MAIN_PCMS_APPL_PAN.CAP_NEXT_MB_DATE = S_MAIN_PCMS_APPL_PAN.CAP_NEXT_MB_DATE,
    MAIN_PCMS_APPL_PAN.CAP_FEE_CALC = S_MAIN_PCMS_APPL_PAN.CAP_FEE_CALC,
    MAIN_PCMS_APPL_PAN.CAP_ISSUE_FLAG = S_MAIN_PCMS_APPL_PAN.CAP_ISSUE_FLAG,
    MAIN_PCMS_APPL_PAN.CAP_REQUEST_ID = S_MAIN_PCMS_APPL_PAN.CAP_REQUEST_ID,
    MAIN_PCMS_APPL_PAN.CAP_RULE_INDICATOR = S_MAIN_PCMS_APPL_PAN.CAP_RULE_INDICATOR,
    MAIN_PCMS_APPL_PAN.CAP_RULEGROUP_CODE = S_MAIN_PCMS_APPL_PAN.CAP_RULEGROUP_CODE,
    MAIN_PCMS_APPL_PAN.CAP_EMB_BATCHNO = S_MAIN_PCMS_APPL_PAN.CAP_EMB_BATCHNO,
    MAIN_PCMS_APPL_PAN.CAP_IPIN_OFFSET = S_MAIN_PCMS_APPL_PAN.CAP_IPIN_OFFSET,
    MAIN_PCMS_APPL_PAN.CAP_EMP_ID = S_MAIN_PCMS_APPL_PAN.CAP_EMP_ID,
    MAIN_PCMS_APPL_PAN.CAP_FIRSTTIME_TOPUP = S_MAIN_PCMS_APPL_PAN.CAP_FIRSTTIME_TOPUP,
    MAIN_PCMS_APPL_PAN.CAP_INV_FLAG = S_MAIN_PCMS_APPL_PAN.CAP_INV_FLAG,
    MAIN_PCMS_APPL_PAN.CAP_PANMAST_PARAM1 = S_MAIN_PCMS_APPL_PAN.CAP_PANMAST_PARAM1,
    MAIN_PCMS_APPL_PAN.CAP_PANMAST_PARAM2 = S_MAIN_PCMS_APPL_PAN.CAP_PANMAST_PARAM2,
    MAIN_PCMS_APPL_PAN.CAP_PANMAST_PARAM3 = S_MAIN_PCMS_APPL_PAN.CAP_PANMAST_PARAM3,
    MAIN_PCMS_APPL_PAN.CAP_PANMAST_PARAM4 = S_MAIN_PCMS_APPL_PAN.CAP_PANMAST_PARAM4,
    MAIN_PCMS_APPL_PAN.CAP_PANMAST_PARAM5 = S_MAIN_PCMS_APPL_PAN.CAP_PANMAST_PARAM5,
    MAIN_PCMS_APPL_PAN.CAP_PANMAST_PARAM6 = S_MAIN_PCMS_APPL_PAN.CAP_PANMAST_PARAM6,
    MAIN_PCMS_APPL_PAN.CAP_PANMAST_PARAM7 = S_MAIN_PCMS_APPL_PAN.CAP_PANMAST_PARAM7,
    MAIN_PCMS_APPL_PAN.CAP_PANMAST_PARAM8 = S_MAIN_PCMS_APPL_PAN.CAP_PANMAST_PARAM8,
    MAIN_PCMS_APPL_PAN.CAP_PANMAST_PARAM9 = S_MAIN_PCMS_APPL_PAN.CAP_PANMAST_PARAM9,
    MAIN_PCMS_APPL_PAN.CAP_PANMAST_PARAM10 = S_MAIN_PCMS_APPL_PAN.CAP_PANMAST_PARAM10,
    MAIN_PCMS_APPL_PAN.CAP_IKIT_FLAG = S_MAIN_PCMS_APPL_PAN.CAP_IKIT_FLAG,
    MAIN_PCMS_APPL_PAN.CAP_PAN_CODE_ENCR = S_MAIN_PCMS_APPL_PAN.CAP_PAN_CODE_ENCR,
    MAIN_PCMS_APPL_PAN.CAP_ECOM_ONLINE_LIMIT = S_MAIN_PCMS_APPL_PAN.CAP_ECOM_ONLINE_LIMIT,
    MAIN_PCMS_APPL_PAN.CAP_ECOM_OFFLINE_LIMIT = S_MAIN_PCMS_APPL_PAN.CAP_ECOM_OFFLINE_LIMIT,
    MAIN_PCMS_APPL_PAN.CAP_PROXY_numeric = S_MAIN_PCMS_APPL_PAN.CAP_PROXY_numeric,
    MAIN_PCMS_APPL_PAN.CAP_MMPOS_ONLINE_LIMIT = S_MAIN_PCMS_APPL_PAN.CAP_MMPOS_ONLINE_LIMIT,
    MAIN_PCMS_APPL_PAN.CAP_MMPOS_OFFLINE_LIMIT = S_MAIN_PCMS_APPL_PAN.CAP_MMPOS_OFFLINE_LIMIT,
    MAIN_PCMS_APPL_PAN.CAP_STARTERCARD_FLAG = S_MAIN_PCMS_APPL_PAN.CAP_STARTERCARD_FLAG,
    MAIN_PCMS_APPL_PAN.CAP_SERIAL_numeric = S_MAIN_PCMS_APPL_PAN.CAP_SERIAL_numeric,
    MAIN_PCMS_APPL_PAN.CAP_INACTIVE_FEECALC_DATE = S_MAIN_PCMS_APPL_PAN.CAP_INACTIVE_FEECALC_DATE,
    MAIN_PCMS_APPL_PAN.CAP_PRFL_CODE = S_MAIN_PCMS_APPL_PAN.CAP_PRFL_CODE,
    MAIN_PCMS_APPL_PAN.CAP_PRFL_LEVL = S_MAIN_PCMS_APPL_PAN.CAP_PRFL_LEVL,
    MAIN_PCMS_APPL_PAN.CAP_MASK_PAN = S_MAIN_PCMS_APPL_PAN.CAP_MASK_PAN,
    MAIN_PCMS_APPL_PAN.PAN_BIN = S_MAIN_PCMS_APPL_PAN.PAN_BIN,
    MAIN_PCMS_APPL_PAN.CAP_PROXY_MSG = S_MAIN_PCMS_APPL_PAN.CAP_PROXY_MSG,
    MAIN_PCMS_APPL_PAN.CAP_REPL_FLAG = S_MAIN_PCMS_APPL_PAN.CAP_REPL_FLAG,
    MAIN_PCMS_APPL_PAN.CAP_NEXT_WB_DATE = S_MAIN_PCMS_APPL_PAN.CAP_NEXT_WB_DATE,
    MAIN_PCMS_APPL_PAN.CAP_WALT_ID = S_MAIN_PCMS_APPL_PAN.CAP_WALT_ID,
    MAIN_PCMS_APPL_PAN.CAP_IBAN_ID = S_MAIN_PCMS_APPL_PAN.CAP_IBAN_ID,
    MAIN_PCMS_APPL_PAN.CAP_EMBOSS_LINE4 = S_MAIN_PCMS_APPL_PAN.CAP_EMBOSS_LINE4,
    MAIN_PCMS_APPL_PAN.CAP_TRAVEL_PURPOSE = S_MAIN_PCMS_APPL_PAN.CAP_TRAVEL_PURPOSE,
    MAIN_PCMS_APPL_PAN.CAP_ORDER_RCPT_FLG = S_MAIN_PCMS_APPL_PAN.CAP_ORDER_RCPT_FLG,
    MAIN_PCMS_APPL_PAN.CAP_CORPORATE_ID = S_MAIN_PCMS_APPL_PAN.CAP_CORPORATE_ID,
    MAIN_PCMS_APPL_PAN.CAP_FNC_ACTIVE_DATE = S_MAIN_PCMS_APPL_PAN.CAP_FNC_ACTIVE_DATE,
    MAIN_PCMS_APPL_PAN.CAP_FNC_CLOSURE_DATE = S_MAIN_PCMS_APPL_PAN.CAP_FNC_CLOSURE_DATE,
    MAIN_PCMS_APPL_PAN.CAP_FORFEITURE_DATE = S_MAIN_PCMS_APPL_PAN.CAP_FORFEITURE_DATE,
    MAIN_PCMS_APPL_PAN.CAP_NEXT_ANL_DATE = S_MAIN_PCMS_APPL_PAN.CAP_NEXT_ANL_DATE,
    MAIN_PCMS_APPL_PAN.CAP_CORPFEE_FLAG = S_MAIN_PCMS_APPL_PAN.CAP_CORPFEE_FLAG,
    MAIN_PCMS_APPL_PAN.CAP_EMBOSS_LINE3 = S_MAIN_PCMS_APPL_PAN.CAP_EMBOSS_LINE3 from
    EDW.MAIN_PCMS_APPL_PAN,EDW.S_MAIN_PCMS_APPL_PAN
    where EDW.MAIN_PCMS_APPL_PAN.CAP_PAN_CODE_ENCR = EDW.S_MAIN_PCMS_APPL_PAN.CAP_PAN_CODE_ENCR;
  insert into #UPS_MAIN_PCMS_APPL_PAN
    select S_MAIN_PCMS_APPL_PAN.CAP_PAN_CODE_ENCR,
      MAIN_PCMS_APPL_PAN.CAP_PAN_CODE_ENCR as SYB_CAP_PAN_CODE_ENCR
      from EDW.S_MAIN_PCMS_APPL_PAN left outer join EDW.MAIN_PCMS_APPL_PAN
        on S_MAIN_PCMS_APPL_PAN.CAP_PAN_CODE_ENCR = MAIN_PCMS_APPL_PAN.CAP_PAN_CODE_ENCR;
  insert into EDW.MAIN_PCMS_APPL_PAN select A.* from EDW.S_MAIN_PCMS_APPL_PAN as A,#UPS_MAIN_PCMS_APPL_PAN as B
      where A.CAP_PAN_CODE_ENCR = B.CAP_PAN_CODE_ENCR
      and B.SYB_CAP_PAN_CODE_ENCR is null;
  commit work
end
