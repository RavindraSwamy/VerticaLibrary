create procedure edw.pcms_transaction_log()
begin
  truncate table EDW.S_MAIN_PCMS_TRANSACTIONLOG;
  commit work;
  load into table EDW.S_MAIN_PCMS_TRANSACTIONLOG( MSGTYPE '|^|' null(zeros,'NULL','null'),RRN '|^|' null(zeros,'NULL','null'),DELIVERY_CHANNEL '|^|' null(zeros,'NULL','null'),TERMINAL_ID '|^|' null(zeros,'NULL','null'),DATE_TIME '|^|' null(zeros,'NULL','null'),TXN_CODE '|^|' null(zeros,'NULL','null'),TXN_TYPE '|^|' null(zeros,'NULL','null'),TXN_MODE '|^|' null(zeros,'NULL','null'),TXN_STATUS '|^|' null(zeros,'NULL','null'),RESPONSE_CODE '|^|' null(zeros,'NULL','null'),BUSINESS_DATE '|^|' null(zeros,'NULL','null'),BUSINESS_TIME '|^|' null(zeros,'NULL','null'),CUSTOMER_CARD_NO '|^|' null(zeros,'NULL','null'),TOPUP_CARD_NO '|^|' null(zeros,'NULL','null'),TOPUP_ACCT_NO '|^|' null(zeros,'NULL','null'),TOPUP_ACCT_TYPE '|^|' null(zeros,'NULL','null'),BANK_CODE '|^|' null(zeros,'NULL','null'),TOTAL_AMOUNT '|^|' null(zeros,'NULL','null'),RULE_INDICATOR '|^|' null(zeros,'NULL','null'),RULEGROUPID '|^|' null(zeros,'NULL','null'),MCCODE '|^|' null(zeros,'NULL','null'),CURRENCYCODE '|^|' null(zeros,'NULL','null'),ADDCHARGE '|^|' null(zeros,'NULL','null'),PRODUCTID '|^|' null(zeros,'NULL','null'),CATEGORYID '|^|' null(zeros,'NULL','null'),TIPS '|^|' null(zeros,'NULL','null'),DECLINE_RULEID '|^|' null(zeros,'NULL','null'),ATM_NAME_LOCATION '|^|' null(zeros,'NULL','null'),AUTH_ID '|^|' null(zeros,'NULL','null'),TRANS_DESC '|^|' null(zeros,'NULL','null'),AMOUNT '|^|' null(zeros,'NULL','null'),PREAUTHAMOUNT '|^|' null(zeros,'NULL','null'),PARTIALAMOUNT '|^|' null(zeros,'NULL','null'),MCCODEGROUPID '|^|' null(zeros,'NULL','null'),CURRENCYCODEGROUPID '|^|' null(zeros,'NULL','null'),TRANSCODEGROUPID '|^|' null(zeros,'NULL','null'),RULES '|^|' null(zeros,'NULL','null'),PREAUTH_DATE '|^|' null(zeros,'NULL','null'),CR_DR_FLAG '|^|' null(zeros,'NULL','null'),PROCESSES_FLAG '|^|' null(zeros,'NULL','null'),TRANSACTIONLOG '|^|' null(zeros,'NULL','null'),GL_UPD_FLAG '|^|' null(zeros,'NULL','null'),GL_EOD_FLAG '|^|' null(zeros,'NULL','null'),SYSTEM_TRACE_AUDIT_NO '|^|' null(zeros,'NULL','null'),INSTCODE '|^|' null(zeros,'NULL','null'),FEECODE '|^|' null(zeros,'NULL','null'),FEEATTACHTYPE '|^|' null(zeros,'NULL','null'),TRANFEE_AMT '|^|' null(zeros,'NULL','null'),SERVICETAX_AMT '|^|' null(zeros,'NULL','null'),CESS_AMT '|^|' null(zeros,'NULL','null'),TRANFEE_CR_ACCTNO '|^|' null(zeros,'NULL','null'),TRANFEE_DR_ACCTNO '|^|' null(zeros,'NULL','null'),TRAN_ST_CALC_FLAG '|^|' null(zeros,'NULL','null'),TRAN_CESS_CALC_FLAG '|^|' null(zeros,'NULL','null'),TRAN_ST_CR_ACCTNO '|^|' null(zeros,'NULL','null'),TRAN_ST_DR_ACCTNO '|^|' null(zeros,'NULL','null'),TRAN_CESS_CR_ACCTNO '|^|' null(zeros,'NULL','null'),TRAN_CESS_DR_ACCTNO '|^|' null(zeros,'NULL','null'),TRAN_REVERSE_FLAG '|^|' null(zeros,'NULL','null'),ADD_LUPD_DATE '|^|' null(zeros,'NULL','null'),ADD_LUPD_USER '|^|' null(zeros,'NULL','null'),ADD_INS_DATE '|^|' null(zeros,'NULL','null'),ADD_INS_USER '|^|' null(zeros,'NULL','null'),TRAN_CURR '|^|' null(zeros,'NULL','null'),PAN_TRANS_FLAG '|^|' null(zeros,'NULL','null'),CUSTOMER_CARD_NO_ENCR '|^|' null(zeros,'NULL','null'),TOPUP_CARD_NO_ENCR '|^|' null(zeros,'NULL','null'),CUSTOMER_ACCT_NO '|^|' null(zeros,'NULL','null'),ERROR_MSG '|^|' null(zeros,'NULL','null'),ORGNL_CARD_NO '|^|' null(zeros,'NULL','null'),ORGNL_RRN '|^|' null(zeros,'NULL','null'),ORGNL_BUSINESS_DATE '|^|' null(zeros,'NULL','null'),ORGNL_BUSINESS_TIME '|^|' null(zeros,'NULL','null'),ORGNL_TERMINAL_ID '|^|' null(zeros,'NULL','null'),LEDGER_BALANCE '|^|' null(zeros,'NULL','null'),REVERSAL_CODE '|^|' null(zeros,'NULL','null'),PROXY_NUMBER '|^|' null(zeros,'NULL','null'),ACCT_BALANCE '|^|' null(zeros,'NULL','null'),ADDR_VERIFY_RESPONSE '|^|' null(zeros,'NULL','null'),INTERNATION_IND_RESPONSE '|^|' null(zeros,'NULL','null'),RETURNACHFILENAME '|^|' null(zeros,'NULL','null'),ODFI '|^|' null(zeros,'NULL','null'),RDFI '|^|' null(zeros,'NULL','null'),SECCODES '|^|' null(zeros,'NULL','null'),IMPDATE '|^|' null(zeros,'NULL','null'),PROCESSDATE '|^|' null(zeros,'NULL','null'),EFFECTIVEDATE '|^|' null(zeros,'NULL','null'),TRACENUMBER '|^|' null(zeros,'NULL','null'),ACHTRANTYPE_ID '|^|' null(zeros,'NULL','null'),INCOMING_CRFILEID '|^|' null(zeros,'NULL','null'),ACHFILENAME '|^|' null(zeros,'NULL','null'),ACH_FILE_PATH '|^|' null(zeros,'NULL','null'),BEFRETRAN_LEDGERBAL '|^|' null(zeros,'NULL','null'),BEFRETRAN_AVAILBALANCE '|^|' null(zeros,'NULL','null'),ACHRETURNTFILE_TIMESTAMP '|^|' null(zeros,'NULL','null'),INDIDNUM '|^|' null(zeros,'NULL','null'),INDNAME '|^|' null(zeros,'NULL','null'),COMPANYNAME '|^|' null(zeros,'NULL','null'),COMPANYID '|^|' null(zeros,'NULL','null'),ACH_ID '|^|' null(zeros,'NULL','null'),COMPENTRYDESC '|^|' null(zeros,'NULL','null'),FEE_REVERSAL_FLAG '|^|' null(zeros,'NULL','null'),REMARK '|^|' null(zeros,'NULL','null'),RESPONSE_ID '|^|' null(zeros,'NULL','null'),IPADDRESS '|^|' null(zeros,'NULL','null'),ANI '|^|' null(zeros,'NULL','null'),DNI '|^|' null(zeros,'NULL','null'),CUSTOMERLASTNAME '|^|' null(zeros,'NULL','null'),CARDSTATUS '|^|' null(zeros,'NULL','null'),PROCESSTYPE '|^|' null(zeros,'NULL','null'),REASON '|^|' null(zeros,'NULL','null'),CUSTOMER_STARTER_CARD_NO '|^|' null(zeros,'NULL','null'),GPRCARDAPPLICATIONNO '|^|' null(zeros,'NULL','null'),CSR_ACHACTIONTAKEN '|^|' null(zeros,'NULL','null'),DISPUTE_FLAG '|^|' null(zeros,'NULL','null'),INTERCHANGE_FEEAMT '|^|' null(zeros,'NULL','null'),NETWORK_ID '|^|' null(zeros,'NULL','null'),MERCHANT_ZIP '|^|' null(zeros,'NULL','null'),MERCHANT_ID '|^|' null(zeros,'NULL','null'),COUNTRY_CODE '|^|' null(zeros,'NULL','null'),FEE_PLAN '|^|' null(zeros,'NULL','null'),POS_VERIFICATION '|^|' null(zeros,'NULL','null'),ZIP_CODE '|^|' null(zeros,'NULL','null'),PARTIAL_PREAUTH_IND '|^|' null(zeros,'NULL','null'),MERCHANT_NAME '|^|' null(zeros,'NULL','null'),MERCHANT_CITY '|^|' null(zeros,'NULL','null'),MERCHANT_STATE '|^|' null(zeros,'NULL','null'),ADDR_VERIFY_INDICATOR '|^|' null(zeros,'NULL','null'),GPRPIN_FLAG '|^|' null(zeros,'NULL','null'),CUSTFIRSTNAME '|^|' null(zeros,'NULL','null'),CLAWBACK_INDICATOR '|^|' null(zeros,'NULL','null'),NETWORK_SETTL_DATE '|^|' null(zeros,'NULL','null'),ACH_EXCEPTION_QUEUE_FLAG '|^|' null(zeros,'NULL','null'),SSN_FAIL_DTLS '|^|' null(zeros,'NULL','null'),MATCH_RULE '|^|' null(zeros,'NULL','null'),TOPUP_ACCT_BALANCE '|^|' null(zeros,'NULL','null'),TOPUP_LEDGER_BALANCE '|^|' null(zeros,'NULL','null'),ACH_AUTO_CLEAR_FLAG '|^|' null(zeros,'NULL','null'),TIME_STAMP '|^|' null(zeros,'NULL','null'),ACCT_TYPE '|^|' null(zeros,'NULL','null'),PREAUTH_LASTCOMP_IND '|^|' null(zeros,'NULL','null'),ADDL_AMNT '|^|' null(zeros,'NULL','null'),ORIGINAL_STAN '|^|' null(zeros,'NULL','null'),NETWORKID_SWITCH '|^|' null(zeros,'NULL','null'),NETWORKID_ACQUIRER '|^|' null(zeros,'NULL','null'),MEDAGATEREF_ID '|^|' null(zeros,'NULL','null'),MCC_ADDORDEL_FLAG '|^|' null(zeros,'NULL','null'),PERMRULE_VERIFY_FLAG '|^|' null(zeros,'NULL','null'),COMPLETION_COUNT '|^|' null(zeros,'NULL','null'),CVV_VERIFICATIONTYPE '|^|' null(zeros,'NULL','null'),STORE_ID '|^|' null(zeros,'NULL','null'),ORGNL_ACQU_AMT '|^|' null(zeros,'NULL','null'),ORGNL_ACQU_CURR '|^|' null(zeros,'NULL','null'),FXFEE_AMT '|^|' null(zeros,'NULL','null'),DCC_FLAG '|^|' null(zeros,'NULL','null'),FORCE_POST_TXN '|^|' null(zeros,'NULL','null'),RECON_FILENAME '|^|' null(zeros,'NULL','null'),RECON_ARN '|^|' null(zeros,'NULL','null'),RECON_INCGFEE_CCY '|^|' null(zeros,'NULL','null'),RECON_INCGFEE_AMT '|^|' null(zeros,'NULL','null'),RECON_DATE '|^|' null(zeros,'NULL','null'),RECON_CLRING_FILEID '|^|' null(zeros,'NULL','null'),INCG_FEETYP_CODE '|^|' null(zeros,'NULL','null'),SETTLEMENT_CURR '|^|' null(zeros,'NULL','null'),SETTLEMENT_AMT '|^|' null(zeros,'NULL','null'),CROSS_BORDER_INDC '|^|' null(zeros,'NULL','null'),INTERCHANGE_FEE_TYPE '|^|' null(zeros,'NULL','null'),INTERCHANGE_FEE_CURR '|^|' null(zeros,'NULL','null'),SETTLED_DATE '|^|' null(zeros,'NULL','null'),TRAVLPURP '|^|' null(zeros,'NULL','null'),PAYMENT_MODE '|^|' null(zeros,'NULL','null'),POSTING_DATE '|^|' null(zeros,'NULL','null'),SURCHARGE_AMT '|^|' null(zeros,'NULL','null'),SURCHARGE_RVSL_FLAG '|^|' null(zeros,'NULL','null'),FEE_WAIV_FLAG '|^|' null(zeros,'NULL','null'),FEE_WAIV_AMT '|^|' null(zeros,'NULL','null'),SERVTAX_WAIV_AMT '|^|' null(zeros,'NULL','null'),CESS_WAIV_AMT '|^|' null(zeros,'NULL','null'),SURCHRG_STAX '|^|' null(zeros,'NULL','null'),SURCHRG_CESS '|^|' null(zeros,'NULL','null'),SURCHRG_HOLD_FIXED_AMT '|^|' null(zeros,'NULL','null'),SURCHRG_HOLD_PER '|^|' null(zeros,'NULL','null'),SETTLEMENT_TXN_FLAG '|^|' null(zeros,'NULL','null'),ORGNL_AUTH_ID '|^|' null(zeros,'NULL','null'),PAYMENT_REF_NO '|^|' null(zeros,'NULL','null'),CONVER_RATE '|^|' null(zeros,'NULL','null'),VISA_ICVV_RESPONSE '|^|' null(zeros,'NULL','null'),VISA_CVV2_RESPONSE '|^|' null(zeros,'NULL','null'),CONVER_DATE '|^|' null(zeros,'NULL','null'),MARKUP_STAX '|^|' null(zeros,'NULL','null'),BILLING_CURR '\x0A' null(zeros,'NULL','null') ) using file
    '/sybase_load/LOAD_MANAGEMENT/EPMS/ACCOUNT/YET_TO_LOAD_FILES/pcms_transactionlog.out' quotes off escapes off preview on message log '/sybase_load/LOAD_MANAGEMENT/EPMS/ACCOUNT/LOAD_LOGS/ERROR_RECORDS_MSSG/pcms_transactionlog.out_201508262349.msg' row log '/sybase_load/LOAD_MANAGEMENT/EPMS/ACCOUNT/LOAD_LOGS/ERROR_RECORDS_DATA/pcms_transactionlog.out_201508262349.row' only log all log delimited by '|^|' notify 100000 with checkpoint on;
  commit work;
  insert into EDW.MAIN_PCMS_TRANSACTIONLOG select * from EDW.S_MAIN_PCMS_TRANSACTIONLOG;
  commit work
end
