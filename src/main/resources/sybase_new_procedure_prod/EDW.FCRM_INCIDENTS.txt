create procedure EDW.FCRM_INCIDENTS()
begin
  create table #UPS_INCIDENTS(
    CASEID varchar(255) null,
    SYB_CASEID varchar(255) null,);
  truncate table EDW.s_incidents;
  load into table EDW.s_incidents( INCIDENTID '|^|' null(zeros,'NULL','null'),BANK_ID '|^|' null(zeros,'NULL','null'),STOPPROCESCALATION '|^|' null(zeros,'NULL','null'),ESCRULENUM '|^|' null(zeros,'NULL','null'),OWNERGROUP '|^|' null(zeros,'NULL','null'),USERFIELD6 '|^|' null(zeros,'NULL','null'),USERFIELD7 '|^|' null(zeros,'NULL','null'),USERFIELD8 '|^|' null(zeros,'NULL','null'),USERFIELD9 '|^|' null(zeros,'NULL','null'),USERFIELD10 '|^|' null(zeros,'NULL','null'),USERAMTFIELD1 '|^|' null(zeros,'NULL','null'),USERAMTFIELD2 '|^|' null(zeros,'NULL','null'),USERAMTFIELD3 '|^|' null(zeros,'NULL','null'),USERDATEFIELD1 '|^|' null(zeros,'NULL','null'),MANDUSERFIELD1 '|^|' null(zeros,'NULL','null'),MANDUSERFIELD2 '|^|' null(zeros,'NULL','null'),MANDUSERFIELD3 '|^|' null(zeros,'NULL','null'),MANDUSERFIELD4 '|^|' null(zeros,'NULL','null'),MANDUSERFIELD5 '|^|' null(zeros,'NULL','null'),QUICKINCIFLAG '|^|' null(zeros,'NULL','null'),USERDATEFIELD2 '|^|' null(zeros,'NULL','null'),SERIALID '|^|' null(zeros,'NULL','null'),REQUESTORTYPE '|^|' null(zeros,'NULL','null'),CASETYPE '|^|' null(zeros,'NULL','null'),INCIDENTNAME '|^|' null(zeros,'NULL','null'),CASEID '|^|' null(zeros,'NULL','null'),INCIDENTTYPE '|^|' null(zeros,'NULL','null'),PROCESSID '|^|' null(zeros,'NULL','null'),CURRENTSTEP '|^|' null(zeros,'NULL','null'),ORGID '|^|' null(zeros,'NULL','null'),SUSPECTID '|^|' null(zeros,'NULL','null'),STATUS '|^|' null(zeros,'NULL','null'),HASATTACHMENT '|^|' null(zeros,'NULL','null'),LOCKFIELDS '|^|' null(zeros,'NULL','null'),OWNERUSERID '|^|' null(zeros,'NULL','null'),ASSIGNEDUSERID '|^|' null(zeros,'NULL','null'),CREATEDUSERID '|^|' null(zeros,'NULL','null'),ASSIGNEDGROUPID '|^|' null(zeros,'NULL','null'),CRMCALLID '|^|' null(zeros,'NULL','null'),MERGEDWITH '|^|' null(zeros,'NULL','null'),PRIORITY '|^|' null(zeros,'NULL','null'),STARTDATE '|^|' null(zeros,'NULL','null'),DUEDATE '|^|' null(zeros,'NULL','null'),COMPETITORS '|^|' null(zeros,'NULL','null'),ENDDATE '|^|' null(zeros,'NULL','null'),CURRSTEPDUEDATE '|^|' null(zeros,'NULL','null'),REGION '|^|' null(zeros,'NULL','null'),ISMERGER '|^|' null(zeros,'NULL','null'),ASSIGNEDBYUSERID '|^|' null(zeros,'NULL','null'),TRANSFERREDBYUSERID '|^|' null(zeros,'NULL','null'),BODATECREATED '|^|' null(zeros,'NULL','null'),BOCREATEDBY '|^|' null(zeros,'NULL','null'),BODATEMODIFIED '|^|' null(zeros,'NULL','null'),BOMODIFIEDBY '|^|' null(zeros,'NULL','null'),CONCURDETECT_X '|^|' null(zeros,'NULL','null'),BOACLID '|^|' null(zeros,'NULL','null'),USERFIELD1 '|^|' null(zeros,'NULL','null'),USERFIELD2 '|^|' null(zeros,'NULL','null'),USERFIELD3 '|^|' null(zeros,'NULL','null'),USERFIELD4 '|^|' null(zeros,'NULL','null'),USERFIELD5 '|^|' null(zeros,'NULL','null'),XMLDATA '|^|' null(zeros,'NULL','null'),EXTENSIONID '|^|' null(zeros,'NULL','null'),TIMERSTATUS '|^|' null(zeros,'NULL','null'),CONTACTID '|^|' null(zeros,'NULL','null'),LINKID '|^|' null(zeros,'NULL','null'),CRMCUSTID '|^|' null(zeros,'NULL','null'),BACKENDCUSTID '|^|' null(zeros,'NULL','null'),OPPORTUNITYID '|^|' null(zeros,'NULL','null'),STAGENAME '|^|' null(zeros,'NULL','null'),REQUESTCLASSIFICATION '|^|' null(zeros,'NULL','null'),EFFECTIVEDATE '|^|' null(zeros,'NULL','null'),PREFERREDREPID '|^|' null(zeros,'NULL','null'),FUTUREFLAG '|^|' null(zeros,'NULL','null'),CHANNEL '|^|' null(zeros,'NULL','null'),OVERRIDEDEDUP '|^|' null(zeros,'NULL','null'),INCIDENTOWNERID '|^|' null(zeros,'NULL','null'),DWNLOADDATETIME '|^|' null(zeros,'NULL','null'),STATUSFLAG '|^|' null(zeros,'NULL','null'),FRONTENDREQUESTNUMBER '|^|' null(zeros,'NULL','null'),ASSIGNEDLOCATIONID '|^|' null(zeros,'NULL','null'),OWNEDLOCATIONID '|^|' null(zeros,'NULL','null'),ISROUTED '|^|' null(zeros,'NULL','null'),ESC_DUE_TIME '|^|' null(zeros,'NULL','null'),ESC_LEVEL '|^|' null(zeros,'NULL','null'),CUSTOMERSEGMENT '|^|' null(zeros,'NULL','null'),REPORTEDLOCATIONID '|^|' null(zeros,'NULL','null'),OCCUREDLOCATIONID '|^|' null(zeros,'NULL','null'),ACCOUNTBRANCHID '|^|' null(zeros,'NULL','null'),NOCURSTEPASSIGN '|^|' null(zeros,'NULL','null'),ENTITYEMAIL '|^|' null(zeros,'NULL','null'),ROUTEDTIME '|^|' null(zeros,'NULL','null'),PROCESCDUETIME '|^|' null(zeros,'NULL','null'),STOPESCALATION '|^|' null(zeros,'NULL','null'),FIRSTGROWNID '|^|' null(zeros,'NULL','null'),FIRSTBCOWNID '|^|' null(zeros,'NULL','null'),FIRSTUSEROWNID '|^|' null(zeros,'NULL','null'),CURRNUMPOSESC '|^|' null(zeros,'NULL','null'),CURRNUMNEGESC '|^|' null(zeros,'NULL','null'),NUMOFPOSESC '|^|' null(zeros,'NULL','null'),NUMOFNEGESC '|^|' null(zeros,'NULL','null'),PROCESCLEVEL '|^|' null(zeros,'NULL','null'),MANUALROUTING '|^|' null(zeros,'NULL','null'),SLALEVEL '|^|' null(zeros,'NULL','null'),ROUTERULEFORGROUP '|^|' null(zeros,'NULL','null'),ROUTERULEFORBC '|^|' null(zeros,'NULL','null'),ROUTERULEFORUSER '|^|' null(zeros,'NULL','null'),ASSIGNEDTIME '|^|' null(zeros,'NULL','null'),BACKENDREQUESTNUMBER '|^|' null(zeros,'NULL','null'),STATUSUPDATEDATETIME '|^|' null(zeros,'NULL','null'),ESCALATIONATTR1 '|^|' null(zeros,'NULL','null'),ESCALATIONATTR2 '|^|' null(zeros,'NULL','null'),ESCALATIONATTR3 '|^|' null(zeros,'NULL','null'),REFINCIDENTID '|^|' null(zeros,'NULL','null'),INCIDENTFOR '|^|' null(zeros,'NULL','null'),SERVICEREQUESTTYPE '|^|' null(zeros,'NULL','null'),PRODUCTPROCESSOR '|^|' null(zeros,'NULL','null'),FRONTENDPROCESSOR '|^|' null(zeros,'NULL','null'),ACCOUNTNUMBER '|^|' null(zeros,'NULL','null'),SALESID '|^|' null(zeros,'NULL','null'),LINK '|^|' null(zeros,'NULL','null'),VIEWNAME '|^|' null(zeros,'NULL','null'),PERSONLASTNAME '|^|' null(zeros,'NULL','null'),ACCBRANCHCODE '|^|' null(zeros,'NULL','null'),ACCCURRENCYCODE '|^|' null(zeros,'NULL','null'),ACCTYPE '|^|' null(zeros,'NULL','null'),ACCPRODUCTSKEY '|^|' null(zeros,'NULL','null'),TATDURATION '|^|' null(zeros,'NULL','null'),REASONCODE '|^|' null(zeros,'NULL','null'),LINKEDWITH '|^|' null(zeros,'NULL','null'),ACTIVITYFLAG '|^|' null(zeros,'NULL','null'),ACTIVITYDESCRIPTION '|^|' null(zeros,'NULL','null'),SECURITYILHINT '|^|' null(zeros,'NULL','null'),SECURITYIUHINT '|^|' null(zeros,'NULL','null'),SECURITYGLHINT '|^|' null(zeros,'NULL','null'),SECURITYGUHINT '|^|' null(zeros,'NULL','null'),PROBLEMSUMMARY '|^|' null(zeros,'NULL','null'),CLASSIFICATION1 '|^|' null(zeros,'NULL','null'),CLASSIFICATION2 '|^|' null(zeros,'NULL','null'),CLASSIFICATION3 '|^|' null(zeros,'NULL','null'),CLASSIFICATION4 '|^|' null(zeros,'NULL','null'),CLASSIFICATION5 '|^|' null(zeros,'NULL','null'),FOLDERITEMSID '|^|' null(zeros,'NULL','null'),TYPE1 '|^|' null(zeros,'NULL','null'),TYPE2 '|^|' null(zeros,'NULL','null'),TYPE3 '|^|' null(zeros,'NULL','null'),USERFIELD11 '|^|' null(zeros,'NULL','null'),USERFIELD12 '|^|' null(zeros,'NULL','null'),USERFIELD13 '|^|' null(zeros,'NULL','null'),USERFIELD14 '|^|' null(zeros,'NULL','null'),USERFIELD15 '|^|' null(zeros,'NULL','null'),USERFIELD16 '|^|' null(zeros,'NULL','null'),USERFIELD17 '|^|' null(zeros,'NULL','null'),USERFIELD18 '|^|' null(zeros,'NULL','null'),USERFIELD19 '|^|' null(zeros,'NULL','null'),USERFIELD20 '|^|' null(zeros,'NULL','null'),USERFIELD21 '|^|' null(zeros,'NULL','null'),USERFIELD22 '|^|' null(zeros,'NULL','null'),USERFIELD23 '|^|' null(zeros,'NULL','null'),USERFIELD24 '|^|' null(zeros,'NULL','null'),USERFIELD25 '|^|' null(zeros,'NULL','null'),USERFIELD26 '|^|' null(zeros,'NULL','null'),USERFIELD27 '|^|' null(zeros,'NULL','null'),USERFIELD28 '|^|' null(zeros,'NULL','null'),USERFIELD29 '|^|' null(zeros,'NULL','null'),USERFIELD30 '|^|' null(zeros,'NULL','null'),USERFIELD31 '|^|' null(zeros,'NULL','null'),USERFIELD32 '|^|' null(zeros,'NULL','null'),USERFIELD33 '|^|' null(zeros,'NULL','null'),USERFIELD34 '|^|' null(zeros,'NULL','null'),USERFIELD35 '|^|' null(zeros,'NULL','null'),USERFIELD36 '|^|' null(zeros,'NULL','null'),USERFIELD37 '|^|' null(zeros,'NULL','null'),USERFIELD38 '|^|' null(zeros,'NULL','null'),USERFIELD39 '|^|' null(zeros,'NULL','null'),USERFIELD40 '|^|' null(zeros,'NULL','null'),USERDATEFIELD3 '|^|' null(zeros,'NULL','null'),USERDATEFIELD4 '|^|' null(zeros,'NULL','null'),USERDATEFIELD5 '|^|' null(zeros,'NULL','null'),USERDATEFIELD6 '|^|' null(zeros,'NULL','null'),USERDATEFIELD7 '|^|' null(zeros,'NULL','null'),USERDATEFIELD8 '|^|' null(zeros,'NULL','null'),USERDATEFIELD9 '|^|' null(zeros,'NULL','null'),USERAMTFIELD4 '|^|' null(zeros,'NULL','null'),USERAMTFIELD5 '|^|' null(zeros,'NULL','null'),USERAMTFIELD6 '|^|' null(zeros,'NULL','null'),USERAMTFIELD7 '|^|' null(zeros,'NULL','null'),USERAMTFIELD8 '|^|' null(zeros,'NULL','null'),LOCKASSIGNMENT '|^|' null(zeros,'NULL','null'),INTERNALREQUEST '|^|' null(zeros,'NULL','null'),REQUESTEDBY '|^|' null(zeros,'NULL','null'),EMAILID '|^|' null(zeros,'NULL','null'),PARENTINTXNID '|^|' null(zeros,'NULL','null'),PREVSTEPENDDATE '|^|' null(zeros,'NULL','null'),ACCESSOWNERGROUP '|^|' null(zeros,'NULL','null'),ACCESSOWNERSEGMENT '|^|' null(zeros,'NULL','null'),ACCESSOWNERBC '|^|' null(zeros,'NULL','null'),ACCESSOWNERAGENT '|^|' null(zeros,'NULL','null'),ACCESSASSIGNEEAGENT '|^|' null(zeros,'NULL','null'),INCENTIVEVALUE '|^|' null(zeros,'NULL','null'),QUOTAID '|^|' null(zeros,'NULL','null'),ACHIEVEMENTCALCULATEDFLAG '|^|' null(zeros,'NULL','null'),INCENTIVECALCULATEDFLAG '|^|' null(zeros,'NULL','null'),TMDATE '|^|' null(zeros,'NULL','null'),SEQ_ID '\x0A' null(zeros,'NULL','null') ) using file
    '/sybase_load/LOAD_MANAGEMENT/FCRM/YET_TO_LOAD_FILES/incidents.out' quotes off escapes off preview on message log '/sybase_load/LOAD_MANAGEMENT/FCRM/LOAD_LOGS/ERROR_RECORDS_MSSG/incidents.out_201508061919.msg' row log '/sybase_load/LOAD_MANAGEMENT/FCRM/LOAD_LOGS/ERROR_RECORDS_DATA/incidents.out_201508061919.row' only log all log delimited by '|^|' notify 100000 with checkpoint on;
  delete from EDW.s_incidents as A from
    EDW.s_incidents as A
    ,(select MAX(ROWID(s_incidents)) as ROW_ID,
      CASEID from EDW.s_incidents
      group by CASEID) as B
    where A.CASEID = B.CASEID
    and ROWID(A) <> B.ROW_ID;
  update EDW.INCIDENTS
    set INCIDENTS.INCIDENTID = s_incidents.INCIDENTID,
    INCIDENTS.BANK_ID = s_incidents.BANK_ID,
    INCIDENTS.STOPPROCESCALATION = s_incidents.STOPPROCESCALATION,
    INCIDENTS.ESCRULENUM = s_incidents.ESCRULENUM,
    INCIDENTS.OWNERGROUP = s_incidents.OWNERGROUP,
    INCIDENTS.USERFIELD6 = s_incidents.USERFIELD6,
    INCIDENTS.USERFIELD7 = s_incidents.USERFIELD7,
    INCIDENTS.USERFIELD8 = s_incidents.USERFIELD8,
    INCIDENTS.USERFIELD9 = s_incidents.USERFIELD9,
    INCIDENTS.USERFIELD10 = s_incidents.USERFIELD10,
    INCIDENTS.USERAMTFIELD1 = s_incidents.USERAMTFIELD1,
    INCIDENTS.USERAMTFIELD2 = s_incidents.USERAMTFIELD2,
    INCIDENTS.USERAMTFIELD3 = s_incidents.USERAMTFIELD3,
    INCIDENTS.USERDATEFIELD1 = s_incidents.USERDATEFIELD1,
    INCIDENTS.MANDUSERFIELD1 = s_incidents.MANDUSERFIELD1,
    INCIDENTS.MANDUSERFIELD2 = s_incidents.MANDUSERFIELD2,
    INCIDENTS.MANDUSERFIELD3 = s_incidents.MANDUSERFIELD3,
    INCIDENTS.MANDUSERFIELD4 = s_incidents.MANDUSERFIELD4,
    INCIDENTS.MANDUSERFIELD5 = s_incidents.MANDUSERFIELD5,
    INCIDENTS.QUICKINCIFLAG = s_incidents.QUICKINCIFLAG,
    INCIDENTS.USERDATEFIELD2 = s_incidents.USERDATEFIELD2,
    INCIDENTS.SERIALID = s_incidents.SERIALID,
    INCIDENTS.REQUESTORTYPE = s_incidents.REQUESTORTYPE,
    INCIDENTS.CASETYPE = s_incidents.CASETYPE,
    INCIDENTS.INCIDENTNAME = s_incidents.INCIDENTNAME,
    INCIDENTS.CASEID = s_incidents.CASEID,
    INCIDENTS.INCIDENTTYPE = s_incidents.INCIDENTTYPE,
    INCIDENTS.PROCESSID = s_incidents.PROCESSID,
    INCIDENTS.CURRENTSTEP = s_incidents.CURRENTSTEP,
    INCIDENTS.ORGID = s_incidents.ORGID,
    INCIDENTS.SUSPECTID = s_incidents.SUSPECTID,
    INCIDENTS.STATUS = s_incidents.STATUS,
    INCIDENTS.HASATTACHMENT = s_incidents.HASATTACHMENT,
    INCIDENTS.LOCKFIELDS = s_incidents.LOCKFIELDS,
    INCIDENTS.OWNERUSERID = s_incidents.OWNERUSERID,
    INCIDENTS.ASSIGNEDUSERID = s_incidents.ASSIGNEDUSERID,
    INCIDENTS.CREATEDUSERID = s_incidents.CREATEDUSERID,
    INCIDENTS.ASSIGNEDGROUPID = s_incidents.ASSIGNEDGROUPID,
    INCIDENTS.CRMCALLID = s_incidents.CRMCALLID,
    INCIDENTS.MERGEDWITH = s_incidents.MERGEDWITH,
    INCIDENTS.PRIORITY = s_incidents.PRIORITY,
    INCIDENTS.STARTDATE = s_incidents.STARTDATE,
    INCIDENTS.DUEDATE = s_incidents.DUEDATE,
    INCIDENTS.COMPETITORS = s_incidents.COMPETITORS,
    INCIDENTS.ENDDATE = s_incidents.ENDDATE,
    INCIDENTS.CURRSTEPDUEDATE = s_incidents.CURRSTEPDUEDATE,
    INCIDENTS.REGION = s_incidents.REGION,
    INCIDENTS.ISMERGER = s_incidents.ISMERGER,
    INCIDENTS.ASSIGNEDBYUSERID = s_incidents.ASSIGNEDBYUSERID,
    INCIDENTS.TRANSFERREDBYUSERID = s_incidents.TRANSFERREDBYUSERID,
    INCIDENTS.BODATECREATED = s_incidents.BODATECREATED,
    INCIDENTS.BOCREATEDBY = s_incidents.BOCREATEDBY,
    INCIDENTS.BODATEMODIFIED = s_incidents.BODATEMODIFIED,
    INCIDENTS.BOMODIFIEDBY = s_incidents.BOMODIFIEDBY,
    INCIDENTS.CONCURDETECT_X = s_incidents.CONCURDETECT_X,
    INCIDENTS.BOACLID = s_incidents.BOACLID,
    INCIDENTS.USERFIELD1 = s_incidents.USERFIELD1,
    INCIDENTS.USERFIELD2 = s_incidents.USERFIELD2,
    INCIDENTS.USERFIELD3 = s_incidents.USERFIELD3,
    INCIDENTS.USERFIELD4 = s_incidents.USERFIELD4,
    INCIDENTS.USERFIELD5 = s_incidents.USERFIELD5,
    INCIDENTS.XMLDATA = s_incidents.XMLDATA,
    INCIDENTS.EXTENSIONID = s_incidents.EXTENSIONID,
    INCIDENTS.TIMERSTATUS = s_incidents.TIMERSTATUS,
    INCIDENTS.CONTACTID = s_incidents.CONTACTID,
    INCIDENTS.LINKID = s_incidents.LINKID,
    INCIDENTS.CRMCUSTID = s_incidents.CRMCUSTID,
    INCIDENTS.BACKENDCUSTID = s_incidents.BACKENDCUSTID,
    INCIDENTS.OPPORTUNITYID = s_incidents.OPPORTUNITYID,
    INCIDENTS.STAGENAME = s_incidents.STAGENAME,
    INCIDENTS.REQUESTCLASSIFICATION = s_incidents.REQUESTCLASSIFICATION,
    INCIDENTS.EFFECTIVEDATE = s_incidents.EFFECTIVEDATE,
    INCIDENTS.PREFERREDREPID = s_incidents.PREFERREDREPID,
    INCIDENTS.FUTUREFLAG = s_incidents.FUTUREFLAG,
    INCIDENTS.CHANNEL = s_incidents.CHANNEL,
    INCIDENTS.OVERRIDEDEDUP = s_incidents.OVERRIDEDEDUP,
    INCIDENTS.INCIDENTOWNERID = s_incidents.INCIDENTOWNERID,
    INCIDENTS.DWNLOADDATETIME = s_incidents.DWNLOADDATETIME,
    INCIDENTS.STATUSFLAG = s_incidents.STATUSFLAG,
    INCIDENTS.FRONTENDREQUESTNUMBER = s_incidents.FRONTENDREQUESTNUMBER,
    INCIDENTS.ASSIGNEDLOCATIONID = s_incidents.ASSIGNEDLOCATIONID,
    INCIDENTS.OWNEDLOCATIONID = s_incidents.OWNEDLOCATIONID,
    INCIDENTS.ISROUTED = s_incidents.ISROUTED,
    INCIDENTS.ESC_DUE_TIME = s_incidents.ESC_DUE_TIME,
    INCIDENTS.ESC_LEVEL = s_incidents.ESC_LEVEL,
    INCIDENTS.CUSTOMERSEGMENT = s_incidents.CUSTOMERSEGMENT,
    INCIDENTS.REPORTEDLOCATIONID = s_incidents.REPORTEDLOCATIONID,
    INCIDENTS.OCCUREDLOCATIONID = s_incidents.OCCUREDLOCATIONID,
    INCIDENTS.ACCOUNTBRANCHID = s_incidents.ACCOUNTBRANCHID,
    INCIDENTS.NOCURSTEPASSIGN = s_incidents.NOCURSTEPASSIGN,
    INCIDENTS.ENTITYEMAIL = s_incidents.ENTITYEMAIL,
    INCIDENTS.ROUTEDTIME = s_incidents.ROUTEDTIME,
    INCIDENTS.PROCESCDUETIME = s_incidents.PROCESCDUETIME,
    INCIDENTS.STOPESCALATION = s_incidents.STOPESCALATION,
    INCIDENTS.FIRSTGROWNID = s_incidents.FIRSTGROWNID,
    INCIDENTS.FIRSTBCOWNID = s_incidents.FIRSTBCOWNID,
    INCIDENTS.FIRSTUSEROWNID = s_incidents.FIRSTUSEROWNID,
    INCIDENTS.CURRNUMPOSESC = s_incidents.CURRNUMPOSESC,
    INCIDENTS.CURRNUMNEGESC = s_incidents.CURRNUMNEGESC,
    INCIDENTS.NUMOFPOSESC = s_incidents.NUMOFPOSESC,
    INCIDENTS.NUMOFNEGESC = s_incidents.NUMOFNEGESC,
    INCIDENTS.PROCESCLEVEL = s_incidents.PROCESCLEVEL,
    INCIDENTS.MANUALROUTING = s_incidents.MANUALROUTING,
    INCIDENTS.SLALEVEL = s_incidents.SLALEVEL,
    INCIDENTS.ROUTERULEFORGROUP = s_incidents.ROUTERULEFORGROUP,
    INCIDENTS.ROUTERULEFORBC = s_incidents.ROUTERULEFORBC,
    INCIDENTS.ROUTERULEFORUSER = s_incidents.ROUTERULEFORUSER,
    INCIDENTS.ASSIGNEDTIME = s_incidents.ASSIGNEDTIME,
    INCIDENTS.BACKENDREQUESTNUMBER = s_incidents.BACKENDREQUESTNUMBER,
    INCIDENTS.STATUSUPDATEDATETIME = s_incidents.STATUSUPDATEDATETIME,
    INCIDENTS.ESCALATIONATTR1 = s_incidents.ESCALATIONATTR1,
    INCIDENTS.ESCALATIONATTR2 = s_incidents.ESCALATIONATTR2,
    INCIDENTS.ESCALATIONATTR3 = s_incidents.ESCALATIONATTR3,
    INCIDENTS.REFINCIDENTID = s_incidents.REFINCIDENTID,
    INCIDENTS.INCIDENTFOR = s_incidents.INCIDENTFOR,
    INCIDENTS.SERVICEREQUESTTYPE = s_incidents.SERVICEREQUESTTYPE,
    INCIDENTS.PRODUCTPROCESSOR = s_incidents.PRODUCTPROCESSOR,
    INCIDENTS.FRONTENDPROCESSOR = s_incidents.FRONTENDPROCESSOR,
    INCIDENTS.ACCOUNTNUMBER = s_incidents.ACCOUNTNUMBER,
    INCIDENTS.SALESID = s_incidents.SALESID,
    INCIDENTS.LINK = s_incidents.LINK,
    INCIDENTS.VIEWNAME = s_incidents.VIEWNAME,
    INCIDENTS.PERSONLASTNAME = s_incidents.PERSONLASTNAME,
    INCIDENTS.ACCBRANCHCODE = s_incidents.ACCBRANCHCODE,
    INCIDENTS.ACCCURRENCYCODE = s_incidents.ACCCURRENCYCODE,
    INCIDENTS.ACCTYPE = s_incidents.ACCTYPE,
    INCIDENTS.ACCPRODUCTSKEY = s_incidents.ACCPRODUCTSKEY,
    INCIDENTS.TATDURATION = s_incidents.TATDURATION,
    INCIDENTS.REASONCODE = s_incidents.REASONCODE,
    INCIDENTS.LINKEDWITH = s_incidents.LINKEDWITH,
    INCIDENTS.ACTIVITYFLAG = s_incidents.ACTIVITYFLAG,
    INCIDENTS.ACTIVITYDESCRIPTION = s_incidents.ACTIVITYDESCRIPTION,
    INCIDENTS.SECURITYILHINT = s_incidents.SECURITYILHINT,
    INCIDENTS.SECURITYIUHINT = s_incidents.SECURITYIUHINT,
    INCIDENTS.SECURITYGLHINT = s_incidents.SECURITYGLHINT,
    INCIDENTS.SECURITYGUHINT = s_incidents.SECURITYGUHINT,
    INCIDENTS.PROBLEMSUMMARY = s_incidents.PROBLEMSUMMARY,
    INCIDENTS.CLASSIFICATION1 = s_incidents.CLASSIFICATION1,
    INCIDENTS.CLASSIFICATION2 = s_incidents.CLASSIFICATION2,
    INCIDENTS.CLASSIFICATION3 = s_incidents.CLASSIFICATION3,
    INCIDENTS.CLASSIFICATION4 = s_incidents.CLASSIFICATION4,
    INCIDENTS.CLASSIFICATION5 = s_incidents.CLASSIFICATION5,
    INCIDENTS.FOLDERITEMSID = s_incidents.FOLDERITEMSID,
    INCIDENTS.TYPE1 = s_incidents.TYPE1,
    INCIDENTS.TYPE2 = s_incidents.TYPE2,
    INCIDENTS.TYPE3 = s_incidents.TYPE3,
    INCIDENTS.USERFIELD11 = s_incidents.USERFIELD11,
    INCIDENTS.USERFIELD12 = s_incidents.USERFIELD12,
    INCIDENTS.USERFIELD13 = s_incidents.USERFIELD13,
    INCIDENTS.USERFIELD14 = s_incidents.USERFIELD14,
    INCIDENTS.USERFIELD15 = s_incidents.USERFIELD15,
    INCIDENTS.USERFIELD16 = s_incidents.USERFIELD16,
    INCIDENTS.USERFIELD17 = s_incidents.USERFIELD17,
    INCIDENTS.USERFIELD18 = s_incidents.USERFIELD18,
    INCIDENTS.USERFIELD19 = s_incidents.USERFIELD19,
    INCIDENTS.USERFIELD20 = s_incidents.USERFIELD20,
    INCIDENTS.USERFIELD21 = s_incidents.USERFIELD21,
    INCIDENTS.USERFIELD22 = s_incidents.USERFIELD22,
    INCIDENTS.USERFIELD23 = s_incidents.USERFIELD23,
    INCIDENTS.USERFIELD24 = s_incidents.USERFIELD24,
    INCIDENTS.USERFIELD25 = s_incidents.USERFIELD25,
    INCIDENTS.USERFIELD26 = s_incidents.USERFIELD26,
    INCIDENTS.USERFIELD27 = s_incidents.USERFIELD27,
    INCIDENTS.USERFIELD28 = s_incidents.USERFIELD28,
    INCIDENTS.USERFIELD29 = s_incidents.USERFIELD29,
    INCIDENTS.USERFIELD30 = s_incidents.USERFIELD30,
    INCIDENTS.USERFIELD31 = s_incidents.USERFIELD31,
    INCIDENTS.USERFIELD32 = s_incidents.USERFIELD32,
    INCIDENTS.USERFIELD33 = s_incidents.USERFIELD33,
    INCIDENTS.USERFIELD34 = s_incidents.USERFIELD34,
    INCIDENTS.USERFIELD35 = s_incidents.USERFIELD35,
    INCIDENTS.USERFIELD36 = s_incidents.USERFIELD36,
    INCIDENTS.USERFIELD37 = s_incidents.USERFIELD37,
    INCIDENTS.USERFIELD38 = s_incidents.USERFIELD38,
    INCIDENTS.USERFIELD39 = s_incidents.USERFIELD39,
    INCIDENTS.USERFIELD40 = s_incidents.USERFIELD40,
    INCIDENTS.USERDATEFIELD3 = s_incidents.USERDATEFIELD3,
    INCIDENTS.USERDATEFIELD4 = s_incidents.USERDATEFIELD4,
    INCIDENTS.USERDATEFIELD5 = s_incidents.USERDATEFIELD5,
    INCIDENTS.USERDATEFIELD6 = s_incidents.USERDATEFIELD6,
    INCIDENTS.USERDATEFIELD7 = s_incidents.USERDATEFIELD7,
    INCIDENTS.USERDATEFIELD8 = s_incidents.USERDATEFIELD8,
    INCIDENTS.USERDATEFIELD9 = s_incidents.USERDATEFIELD9,
    INCIDENTS.USERAMTFIELD4 = s_incidents.USERAMTFIELD4,
    INCIDENTS.USERAMTFIELD5 = s_incidents.USERAMTFIELD5,
    INCIDENTS.USERAMTFIELD6 = s_incidents.USERAMTFIELD6,
    INCIDENTS.USERAMTFIELD7 = s_incidents.USERAMTFIELD7,
    INCIDENTS.USERAMTFIELD8 = s_incidents.USERAMTFIELD8,
    INCIDENTS.LOCKASSIGNMENT = s_incidents.LOCKASSIGNMENT,
    INCIDENTS.INTERNALREQUEST = s_incidents.INTERNALREQUEST,
    INCIDENTS.REQUESTEDBY = s_incidents.REQUESTEDBY,
    INCIDENTS.EMAILID = s_incidents.EMAILID,
    INCIDENTS.PARENTINTXNID = s_incidents.PARENTINTXNID,
    INCIDENTS.PREVSTEPENDDATE = s_incidents.PREVSTEPENDDATE,
    INCIDENTS.ACCESSOWNERGROUP = s_incidents.ACCESSOWNERGROUP,
    INCIDENTS.ACCESSOWNERSEGMENT = s_incidents.ACCESSOWNERSEGMENT,
    INCIDENTS.ACCESSOWNERBC = s_incidents.ACCESSOWNERBC,
    INCIDENTS.ACCESSOWNERAGENT = s_incidents.ACCESSOWNERAGENT,
    INCIDENTS.ACCESSASSIGNEEAGENT = s_incidents.ACCESSASSIGNEEAGENT,
    INCIDENTS.INCENTIVEVALUE = s_incidents.INCENTIVEVALUE,
    INCIDENTS.QUOTAID = s_incidents.QUOTAID,
    INCIDENTS.ACHIEVEMENTCALCULATEDFLAG = s_incidents.ACHIEVEMENTCALCULATEDFLAG,
    INCIDENTS.INCENTIVECALCULATEDFLAG = s_incidents.INCENTIVECALCULATEDFLAG,
    INCIDENTS.TMDATE = s_incidents.TMDATE,
    INCIDENTS.SEQ_ID = s_incidents.SEQ_ID from
    EDW.INCIDENTS,EDW.s_incidents
    where INCIDENTS.CASEID = s_incidents.CASEID;
  insert into #UPS_INCIDENTS
    select s_incidents.CASEID,
      INCIDENTS.CASEID as SYB_CASEID
      from EDW.s_incidents left outer join EDW.INCIDENTS
        on s_incidents.CASEID = INCIDENTS.CASEID;
  insert into EDW.INCIDENTS
    ( INCIDENTID,
    BANK_ID,
    STOPPROCESCALATION,
    ESCRULENUM,
    OWNERGROUP,
    USERFIELD6,
    USERFIELD7,
    USERFIELD8,
    USERFIELD9,
    USERFIELD10,
    USERAMTFIELD1,
    USERAMTFIELD2,
    USERAMTFIELD3,
    USERDATEFIELD1,
    MANDUSERFIELD1,
    MANDUSERFIELD2,
    MANDUSERFIELD3,
    MANDUSERFIELD4,
    MANDUSERFIELD5,
    QUICKINCIFLAG,
    USERDATEFIELD2,
    SERIALID,
    REQUESTORTYPE,
    CASETYPE,
    INCIDENTNAME,
    CASEID,
    INCIDENTTYPE,
    PROCESSID,
    CURRENTSTEP,
    ORGID,
    SUSPECTID,
    STATUS,
    HASATTACHMENT,
    LOCKFIELDS,
    OWNERUSERID,
    ASSIGNEDUSERID,
    CREATEDUSERID,
    ASSIGNEDGROUPID,
    CRMCALLID,
    MERGEDWITH,
    PRIORITY,
    STARTDATE,
    DUEDATE,
    COMPETITORS,
    ENDDATE,
    CURRSTEPDUEDATE,
    REGION,
    ISMERGER,
    ASSIGNEDBYUSERID,
    TRANSFERREDBYUSERID,
    BODATECREATED,
    BOCREATEDBY,
    BODATEMODIFIED,
    BOMODIFIEDBY,
    CONCURDETECT_X,
    BOACLID,
    USERFIELD1,
    USERFIELD2,
    USERFIELD3,
    USERFIELD4,
    USERFIELD5,
    XMLDATA,
    EXTENSIONID,
    TIMERSTATUS,
    CONTACTID,
    LINKID,
    CRMCUSTID,
    BACKENDCUSTID,
    OPPORTUNITYID,
    STAGENAME,
    REQUESTCLASSIFICATION,
    EFFECTIVEDATE,
    PREFERREDREPID,
    FUTUREFLAG,
    CHANNEL,
    OVERRIDEDEDUP,
    INCIDENTOWNERID,
    DWNLOADDATETIME,
    STATUSFLAG,
    FRONTENDREQUESTNUMBER,
    ASSIGNEDLOCATIONID,
    OWNEDLOCATIONID,
    ISROUTED,
    ESC_DUE_TIME,
    ESC_LEVEL,
    CUSTOMERSEGMENT,
    REPORTEDLOCATIONID,
    OCCUREDLOCATIONID,
    ACCOUNTBRANCHID,
    NOCURSTEPASSIGN,
    ENTITYEMAIL,
    ROUTEDTIME,
    PROCESCDUETIME,
    STOPESCALATION,
    FIRSTGROWNID,
    FIRSTBCOWNID,
    FIRSTUSEROWNID,
    CURRNUMPOSESC,
    CURRNUMNEGESC,
    NUMOFPOSESC,
    NUMOFNEGESC,
    PROCESCLEVEL,
    MANUALROUTING,
    SLALEVEL,
    ROUTERULEFORGROUP,
    ROUTERULEFORBC,
    ROUTERULEFORUSER,
    ASSIGNEDTIME,
    BACKENDREQUESTNUMBER,
    STATUSUPDATEDATETIME,
    ESCALATIONATTR1,
    ESCALATIONATTR2,
    ESCALATIONATTR3,
    REFINCIDENTID,
    INCIDENTFOR,
    SERVICEREQUESTTYPE,
    PRODUCTPROCESSOR,
    FRONTENDPROCESSOR,
    ACCOUNTNUMBER,
    SALESID,
    LINK,
    VIEWNAME,
    PERSONLASTNAME,
    ACCBRANCHCODE,
    ACCCURRENCYCODE,
    ACCTYPE,
    ACCPRODUCTSKEY,
    TATDURATION,
    REASONCODE,
    LINKEDWITH,
    ACTIVITYFLAG,
    ACTIVITYDESCRIPTION,
    SECURITYILHINT,
    SECURITYIUHINT,
    SECURITYGLHINT,
    SECURITYGUHINT,
    PROBLEMSUMMARY,
    CLASSIFICATION1,
    CLASSIFICATION2,
    CLASSIFICATION3,
    CLASSIFICATION4,
    CLASSIFICATION5,
    FOLDERITEMSID,
    TYPE1,
    TYPE2,
    TYPE3,
    USERFIELD11,
    USERFIELD12,
    USERFIELD13,
    USERFIELD14,
    USERFIELD15,
    USERFIELD16,
    USERFIELD17,
    USERFIELD18,
    USERFIELD19,
    USERFIELD20,
    USERFIELD21,
    USERFIELD22,
    USERFIELD23,
    USERFIELD24,
    USERFIELD25,
    USERFIELD26,
    USERFIELD27,
    USERFIELD28,
    USERFIELD29,
    USERFIELD30,
    USERFIELD31,
    USERFIELD32,
    USERFIELD33,
    USERFIELD34,
    USERFIELD35,
    USERFIELD36,
    USERFIELD37,
    USERFIELD38,
    USERFIELD39,
    USERFIELD40,
    USERDATEFIELD3,
    USERDATEFIELD4,
    USERDATEFIELD5,
    USERDATEFIELD6,
    USERDATEFIELD7,
    USERDATEFIELD8,
    USERDATEFIELD9,
    USERAMTFIELD4,
    USERAMTFIELD5,
    USERAMTFIELD6,
    USERAMTFIELD7,
    USERAMTFIELD8,
    LOCKASSIGNMENT,
    INTERNALREQUEST,
    REQUESTEDBY,
    EMAILID,
    PARENTINTXNID,
    PREVSTEPENDDATE,
    ACCESSOWNERGROUP,
    ACCESSOWNERSEGMENT,
    ACCESSOWNERBC,
    ACCESSOWNERAGENT,
    ACCESSASSIGNEEAGENT,
    INCENTIVEVALUE,
    QUOTAID,
    ACHIEVEMENTCALCULATEDFLAG,
    INCENTIVECALCULATEDFLAG,
    TMDATE,
    SEQ_ID ) 
    select s_incidents.INCIDENTID,
      s_incidents.BANK_ID,
      s_incidents.STOPPROCESCALATION,
      s_incidents.ESCRULENUM,
      s_incidents.OWNERGROUP,
      s_incidents.USERFIELD6,
      s_incidents.USERFIELD7,
      s_incidents.USERFIELD8,
      s_incidents.USERFIELD9,
      s_incidents.USERFIELD10,
      s_incidents.USERAMTFIELD1,
      s_incidents.USERAMTFIELD2,
      s_incidents.USERAMTFIELD3,
      s_incidents.USERDATEFIELD1,
      s_incidents.MANDUSERFIELD1,
      s_incidents.MANDUSERFIELD2,
      s_incidents.MANDUSERFIELD3,
      s_incidents.MANDUSERFIELD4,
      s_incidents.MANDUSERFIELD5,
      s_incidents.QUICKINCIFLAG,
      s_incidents.USERDATEFIELD2,
      s_incidents.SERIALID,
      s_incidents.REQUESTORTYPE,
      s_incidents.CASETYPE,
      s_incidents.INCIDENTNAME,
      s_incidents.CASEID,
      s_incidents.INCIDENTTYPE,
      s_incidents.PROCESSID,
      s_incidents.CURRENTSTEP,
      s_incidents.ORGID,
      s_incidents.SUSPECTID,
      s_incidents.STATUS,
      s_incidents.HASATTACHMENT,
      s_incidents.LOCKFIELDS,
      s_incidents.OWNERUSERID,
      s_incidents.ASSIGNEDUSERID,
      s_incidents.CREATEDUSERID,
      s_incidents.ASSIGNEDGROUPID,
      s_incidents.CRMCALLID,
      s_incidents.MERGEDWITH,
      s_incidents.PRIORITY,
      s_incidents.STARTDATE,
      s_incidents.DUEDATE,
      s_incidents.COMPETITORS,
      s_incidents.ENDDATE,
      s_incidents.CURRSTEPDUEDATE,
      s_incidents.REGION,
      s_incidents.ISMERGER,
      s_incidents.ASSIGNEDBYUSERID,
      s_incidents.TRANSFERREDBYUSERID,
      s_incidents.BODATECREATED,
      s_incidents.BOCREATEDBY,
      s_incidents.BODATEMODIFIED,
      s_incidents.BOMODIFIEDBY,
      s_incidents.CONCURDETECT_X,
      s_incidents.BOACLID,
      s_incidents.USERFIELD1,
      s_incidents.USERFIELD2,
      s_incidents.USERFIELD3,
      s_incidents.USERFIELD4,
      s_incidents.USERFIELD5,
      s_incidents.XMLDATA,
      s_incidents.EXTENSIONID,
      s_incidents.TIMERSTATUS,
      s_incidents.CONTACTID,
      s_incidents.LINKID,
      s_incidents.CRMCUSTID,
      s_incidents.BACKENDCUSTID,
      s_incidents.OPPORTUNITYID,
      s_incidents.STAGENAME,
      s_incidents.REQUESTCLASSIFICATION,
      s_incidents.EFFECTIVEDATE,
      s_incidents.PREFERREDREPID,
      s_incidents.FUTUREFLAG,
      s_incidents.CHANNEL,
      s_incidents.OVERRIDEDEDUP,
      s_incidents.INCIDENTOWNERID,
      s_incidents.DWNLOADDATETIME,
      s_incidents.STATUSFLAG,
      s_incidents.FRONTENDREQUESTNUMBER,
      s_incidents.ASSIGNEDLOCATIONID,
      s_incidents.OWNEDLOCATIONID,
      s_incidents.ISROUTED,
      s_incidents.ESC_DUE_TIME,
      s_incidents.ESC_LEVEL,
      s_incidents.CUSTOMERSEGMENT,
      s_incidents.REPORTEDLOCATIONID,
      s_incidents.OCCUREDLOCATIONID,
      s_incidents.ACCOUNTBRANCHID,
      s_incidents.NOCURSTEPASSIGN,
      s_incidents.ENTITYEMAIL,
      s_incidents.ROUTEDTIME,
      s_incidents.PROCESCDUETIME,
      s_incidents.STOPESCALATION,
      s_incidents.FIRSTGROWNID,
      s_incidents.FIRSTBCOWNID,
      s_incidents.FIRSTUSEROWNID,
      s_incidents.CURRNUMPOSESC,
      s_incidents.CURRNUMNEGESC,
      s_incidents.NUMOFPOSESC,
      s_incidents.NUMOFNEGESC,
      s_incidents.PROCESCLEVEL,
      s_incidents.MANUALROUTING,
      s_incidents.SLALEVEL,
      s_incidents.ROUTERULEFORGROUP,
      s_incidents.ROUTERULEFORBC,
      s_incidents.ROUTERULEFORUSER,
      s_incidents.ASSIGNEDTIME,
      s_incidents.BACKENDREQUESTNUMBER,
      s_incidents.STATUSUPDATEDATETIME,
      s_incidents.ESCALATIONATTR1,
      s_incidents.ESCALATIONATTR2,
      s_incidents.ESCALATIONATTR3,
      s_incidents.REFINCIDENTID,
      s_incidents.INCIDENTFOR,
      s_incidents.SERVICEREQUESTTYPE,
      s_incidents.PRODUCTPROCESSOR,
      s_incidents.FRONTENDPROCESSOR,
      s_incidents.ACCOUNTNUMBER,
      s_incidents.SALESID,
      s_incidents.LINK,
      s_incidents.VIEWNAME,
      s_incidents.PERSONLASTNAME,
      s_incidents.ACCBRANCHCODE,
      s_incidents.ACCCURRENCYCODE,
      s_incidents.ACCTYPE,
      s_incidents.ACCPRODUCTSKEY,
      s_incidents.TATDURATION,
      s_incidents.REASONCODE,
      s_incidents.LINKEDWITH,
      s_incidents.ACTIVITYFLAG,
      s_incidents.ACTIVITYDESCRIPTION,
      s_incidents.SECURITYILHINT,
      s_incidents.SECURITYIUHINT,
      s_incidents.SECURITYGLHINT,
      s_incidents.SECURITYGUHINT,
      s_incidents.PROBLEMSUMMARY,
      s_incidents.CLASSIFICATION1,
      s_incidents.CLASSIFICATION2,
      s_incidents.CLASSIFICATION3,
      s_incidents.CLASSIFICATION4,
      s_incidents.CLASSIFICATION5,
      s_incidents.FOLDERITEMSID,
      s_incidents.TYPE1,
      s_incidents.TYPE2,
      s_incidents.TYPE3,
      s_incidents.USERFIELD11,
      s_incidents.USERFIELD12,
      s_incidents.USERFIELD13,
      s_incidents.USERFIELD14,
      s_incidents.USERFIELD15,
      s_incidents.USERFIELD16,
      s_incidents.USERFIELD17,
      s_incidents.USERFIELD18,
      s_incidents.USERFIELD19,
      s_incidents.USERFIELD20,
      s_incidents.USERFIELD21,
      s_incidents.USERFIELD22,
      s_incidents.USERFIELD23,
      s_incidents.USERFIELD24,
      s_incidents.USERFIELD25,
      s_incidents.USERFIELD26,
      s_incidents.USERFIELD27,
      s_incidents.USERFIELD28,
      s_incidents.USERFIELD29,
      s_incidents.USERFIELD30,
      s_incidents.USERFIELD31,
      s_incidents.USERFIELD32,
      s_incidents.USERFIELD33,
      s_incidents.USERFIELD34,
      s_incidents.USERFIELD35,
      s_incidents.USERFIELD36,
      s_incidents.USERFIELD37,
      s_incidents.USERFIELD38,
      s_incidents.USERFIELD39,
      s_incidents.USERFIELD40,
      s_incidents.USERDATEFIELD3,
      s_incidents.USERDATEFIELD4,
      s_incidents.USERDATEFIELD5,
      s_incidents.USERDATEFIELD6,
      s_incidents.USERDATEFIELD7,
      s_incidents.USERDATEFIELD8,
      s_incidents.USERDATEFIELD9,
      s_incidents.USERAMTFIELD4,
      s_incidents.USERAMTFIELD5,
      s_incidents.USERAMTFIELD6,
      s_incidents.USERAMTFIELD7,
      s_incidents.USERAMTFIELD8,
      s_incidents.LOCKASSIGNMENT,
      s_incidents.INTERNALREQUEST,
      s_incidents.REQUESTEDBY,
      s_incidents.EMAILID,
      s_incidents.PARENTINTXNID,
      s_incidents.PREVSTEPENDDATE,
      s_incidents.ACCESSOWNERGROUP,
      s_incidents.ACCESSOWNERSEGMENT,
      s_incidents.ACCESSOWNERBC,
      s_incidents.ACCESSOWNERAGENT,
      s_incidents.ACCESSASSIGNEEAGENT,
      s_incidents.INCENTIVEVALUE,
      s_incidents.QUOTAID,
      s_incidents.ACHIEVEMENTCALCULATEDFLAG,
      s_incidents.INCENTIVECALCULATEDFLAG,
      s_incidents.TMDATE,
      s_incidents.SEQ_ID
      from EDW.s_incidents,EDW.#UPS_INCIDENTS
      where s_incidents.CASEID = #UPS_INCIDENTS.CASEID
      and #UPS_INCIDENTS.SYB_CASEID is null
end
